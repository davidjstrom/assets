(function(t){var g=window.AmazonUIPageJS||window.P,q=g._namespace||g.attributeErrors,w=q?q("VSERelatedVideosClientAssets",""):g;w.guardFatal?w.guardFatal(t)(w,window):w.execute(function(){t(w,window)})})(function(t,g,q){(function(){function w(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})}function U(a,b){b={contentId:""+a.initialVideo.contentId,customerId:a.customerId,foresterMetadataParams:{client:a.requestMetadata.clientId,
marketplaceId:a.requestMetadata.marketplaceId,method:a.requestMetadata.method,requestId:a.requestMetadata.requestId,session:a.requestMetadata.sessionId},mediaSourceInfo:[""+a.initialVideo.videoUrl],posterSource:a.initialVideo.imageUrl,pageAsin:a.requestMetadata.pageAsin,parentId:b,vendorCode:a.initialVideo.vendorCode,videoAds:a.videoAds,shouldStartMuted:a.shouldStartMuted,shouldAutoplay:a.shouldAutoplay,shouldDisableControls:a.shouldDisableControls,twitchCore:a.twitchCore,useCarousel:a.useCarousel,
useBuyBox:a.useBuyBox,languagePreferenceStrings:a.languagePreferenceStrings,sushiMetricsConfig:{eventSource:a.sushiMetricsConfig.eventSource,endpoint:a.sushiMetricsConfig.endpoint,requestId:a.sushiMetricsConfig.requestId,sessionId:a.sushiMetricsConfig.sessionId,customerId:a.sushiMetricsConfig.customerId,refMarkers:a.sushiMetricsConfig.refMarkers,sessionType:a.sushiMetricsConfig.sessionType,placementContext:a.sushiMetricsConfig.placementContext,marketplaceId:a.sushiMetricsConfig.marketplaceId,weblabIds:a.sushiMetricsConfig.weblabIds,
pageAsin:a.sushiMetricsConfig.pageAsin,isInternal:a.sushiMetricsConfig.isInternal,isRobot:a.sushiMetricsConfig.isRobot,clientId:a.sushiMetricsConfig.clientId},refTag:a.refTag};a.eventTimestamp&&(b.eventTimestamp=a.eventTimestamp);return b}g.vseFeatures=g.vseFeatures||{};var H=g.gatedP||{register:function(a,b,f,d,c){void 0===c&&(c=g.vseFeatures);t.now(a).execute(a+"-prereg",function(e){e||c[b]||(c[b]=!0,d.resolve(f(d)).then(function(){t.now(a).execute(a+"-reg",function(f){f||(t.log("Gated registration failed to register module!",
"ERROR",a),c[b]=!1)})}))})},declare:function(a,b,f,d){void 0===d&&(d=g.vseFeatures);t.now(a).execute(a+"-prereg",function(c){c||d[b]||(d[b]=!0,t.declare(a,f))})}},v={count:function(a,b){var f=g.ue;f&&f.count("vse:csm:"+a,b)},emitSushiMetric:function(a,b,f){var d=this;b=b||"https://unagi-na.amazon.com/1/events/com.amazon.eel.vse.metricstest.nexus";f=f||0;if(!(3<=f)){var c=JSON.stringify(a).replace(/\\\\/g,""),e={params:c,paramsFormat:"json",contentType:"application/json; charset\x3dutf-8",error:function(){d.emitSushiMetric(a,
b,++f)}},h=navigator.userAgent.match(/iPhone/i),p=!1;t.now("mash").execute("vse-detect-mshop",function(){p=!0});var x=null!==h&&p;t.when("A").execute("Emit-VSE-Metrics",function(a){navigator&&navigator.sendBeacon&&!x?navigator.sendBeacon(b,c):a.post(b,e)})}},logFatal:function(a,b,f){g.ueLogError&&g.ueLogError(f,{logLevel:"FATAL",attribution:a,message:b})},logError:function(a,b,f){g.ueLogError&&g.ueLogError(f,{logLevel:"ERROR",attribution:a,message:b})}},C={makeApplicationSushiPayloadBuilder:function(a,
b){return function(f){var d={eventSource:b.eventSource,requestId:b.requestId,sessionId:b.sessionId,placementContext:b.placementContext,marketplaceId:b.marketplaceId,weblabIds:b.weblabIds,clientId:b.clientId,isInternal:b.isInternal.toString(),isRobot:b.isRobot.toString(),pageAsin:b.pageAsin,customerId:b.customerId,sessionType:b.sessionType||1,refMarkers:b.refMarkers,eventId:w(),timestamp:new Date,userAgentData:navigator.userAgent,titleSessionId:0,videoAsin:0,pageUrl:g.location.href,videoAsinList:b.videoAsinList||
""};return{events:[{data:a.$.extend(d,f)}]}}}},D={fetchLatestPageState:function(a,b){a.state.replace(b,JSON.parse(a.$("script[type\x3d'a-state'][data-a-state*\x3d"+b+"]").html()));return a.state(b)},isDefined:function(a){return"undefined"!==typeof a&&null!==a}},n={updateReftagParam:function(a,b){return n.updateQueryStringParameter(a,"ref_?","ref",b)},updateQueryStringParameter:function(a,b,f,d){b=new RegExp("([?\x26/])"+b+"\x3d.*?(\x26|$)","i");var c=-1!==a.indexOf("?")?"\x26":"?";return a.match(b)?
a.replace(b,"$1"+f+"\x3d"+d+"$2"):a+c+f+"\x3d"+d},generateUUID:function(){for(var a="",b=0;13>b;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return a},logFatal:function(a,b){var f="VSE_SHARE_WITH_FRIENDS_JS_WIDGET";b&&(f=f+"_"+b);t.log(a,"FATAL",f);return!0},decodeEntities:function(a){var b=document.createElement("textarea");b.innerHTML=a;return b.value},triggerShare:function(a,b,f,d){if(b){b=screen.width;var c=screen.height;f=f?f:.7*
b;d=d?d:.7*c;g.open(a,"_blank","toolbar\x3d0,status\x3d0,width\x3d"+f+",height\x3d"+d+",top\x3d"+(c/2-d/2)+",left\x3d"+(b/2-f/2))}else g.open(a,"_self")},getPageData:function(a){return"undefined"!==typeof a.pageLevelStateKey?A.state(a.pageLevelStateKey):a.pageLevelData},buildUrl:function(a,b,f){b=b||{};var d=Object.keys(b),c=0<d.length&&("sms:"!==a||"IPHONE"!==f)?"?":"";for(f=0;f<d.length;f++)"?"!==c&&(c+="\x26"),b[d[f]]&&(c+=d[f]+"\x3d"+encodeURIComponent(b[d[f]]));return a+c},generateReftags:function(a,
b){var f,d;a=n.getPageData(a);"undefined"!==typeof a&&(f=a.clientRef,d=a.deviceTypeRef);f=f?f:"un";d=d?d:"un";a=b?b:"un";b=n.generateUUID();a="cm_sw_"+a;f=f+"_"+d+"_"+b;return{returnReftag:a+"_r_"+f,clickReftag:a+"_c_"+f}}},V={share:function(a,b){b={facebook:{shareEndpoint:"https://www.facebook.com/dialog/share",params:function(b){return{href:n.decodeEntities(b.url),display:"popup",quote:b.quote?n.decodeEntities(b.quote):"",app_id:"164734381262"}},ref:"fb",height:450,width:700,isWebShare:!0},pinterest:{shareEndpoint:"https://www.pinterest.com/pin/create/button",
params:function(b){return{url:n.decodeEntities(b.url),media:n.decodeEntities(b.image),description:n.decodeEntities(b.description)}},ref:"pi",height:620,width:700,isWebShare:!0},twitter:{shareEndpoint:"https://twitter.com/intent/tweet",params:function(b){var a=n.decodeEntities(b.title);b=n.decodeEntities(b.url);if(a){var f=b?Math.min(b.length,20):-1;200<a.length+f+1&&(a=a.substring(0,200-(f+1+3))+"...")}return{text:a,url:b}},ref:"tw",height:470,width:670,isWebShare:!0},email:{shareEndpoint:"mailto:",
params:function(b){return{subject:n.decodeEntities(b.title),body:n.decodeEntities(b.description)+"\n"+n.decodeEntities(b.url)}},ref:"em",height:470,width:670,isWebShare:!1},sms:{shareEndpoint:"sms:",params:function(b){return{text:n.decodeEntities(b.title)+" "+n.decodeEntities(b.url)}},ref:"sms",height:470,width:670,isWebShare:!1},whatsapp:{shareEndpoint:"https://api.whatsapp.com/send",params:function(b){return{text:n.decodeEntities(b.description)+"\n"+n.decodeEntities(b.url)}},ref:"wa",height:470,
width:670,isWebShare:!1}}[b];var f=n.generateReftags(a,b.ref);a.url=n.updateReftagParam(a.url,f.returnReftag);a=n.buildUrl(b.shareEndpoint,b.params(a),a.devicename);n.triggerShare(a,b.isWebShare,b.width,b.height)}},F={queueComplete:!0},W=function(){function a(b,a,d){var c=this;this.player=b;this.frame=a;this.assets=[];this.currentIndex=0;this.eventEmitter=new d.EventEmitter;this.player.on("playbackComplete",function(){c.currentIndex++;c.doPlay()})}a.prototype.play=function(b){b?this.player.play(b):
this.player.play();return this};a.prototype.getCurrentTime=function(){return this.player.getCurrentTime()};a.prototype.setCurrentTime=function(b){this.player.setCurrentTime(b)};a.prototype.mute=function(){this.player.mute()};a.prototype.unmute=function(){this.player.unmute()};a.prototype.isMuted=function(){return this.player.isMuted()};a.prototype.resume=function(b){this.player.resume(b);return this};a.prototype.pause=function(){this.player.pause();return this};a.prototype.next=function(){this.player.stop();
this.currentIndex++;this.doPlay();return this};a.prototype.previous=function(){this.player.stop();this.currentIndex--;this.doPlay();return this};a.prototype.seek=function(b){this.player.seek(b);return this};a.prototype.enqueue=function(b,a){void 0===a&&(a=this.assets.length);b instanceof Array?(b=b.slice(),b.splice(0,0,this.assets),Array.prototype.splice.apply(this.assets,b)):this.assets.splice(a,0,b);return this};a.prototype.dequeue=function(b){var a=this,d;if("number"===typeof b)d=[b];else if(b instanceof
Array){var c=b.map(function(b){return b.contentId});d=this.assets.map(function(b){return c.indexOf(b.contentId)}).filter(function(b){-1!=b})}else d=[this.assets.map(function(b,a){return a}).filter(function(d){a.assets[d].contentId==b.contentId})[0]];for(var e=0,h=d.length;e<h;e++)this.assets.splice(d[e],1);return this};a.prototype.on=function(b,a){if(F.hasOwnProperty(b))this.eventEmitter.on(b,a);else this.player.on(b,a);return this};a.prototype.off=function(b,a){F.hasOwnProperty(b)?this.eventEmitter.off(b,
a):this.player.off(b,a);return this};a.prototype.onTime=function(b,a,d){this.player.onTime(b,a,d);return this};a.prototype.offTime=function(b,a,d){this.player.offTime(b,a,d);return this};a.prototype.onAd=function(b,a){this.player.onAd(b,a);return this};a.prototype.offAd=function(b,a){this.player.offAd(b,a);return this};a.prototype.show=function(){return this};a.prototype.hide=function(){return this};a.prototype.getAssets=function(){return this.assets};a.prototype.getCurrentAssetIndex=function(){return this.currentIndex-
1};a.prototype.getPosition=function(){return this.player.getPosition()};a.prototype.isPlaying=function(){return this.player.isPlaying()};a.prototype.isPaused=function(){return this.player.isPaused()};a.prototype.getVersion=function(){return this.player.getVersion()};a.prototype.getFlashVersion=function(){return this.player.getFlashVersion()};a.prototype.getRendererType=function(){return this.player.getRendererType()};a.prototype.destroy=function(){this.player.destroy()};a.prototype.doPlay=function(){var b=
this.player.getCurrent();b?this.assets[this.currentIndex].contentId==b.contentId?this.player.play():this.player.play(this.assets[this.currentIndex]):this.assets[this.currentIndex]&&this.player.play(this.assets[this.currentIndex])};return a}(),X=function(){function a(b,a,d,c){this.libs=c;this.eventEmitter=new c.EventEmitter;this.currentAsset=d;this.initHandlers();d=document.getElementById(a.parentId);c=document.createElement("video");var e=a.parentId+"-element";c.id=e;c.className="video-js";c.setAttribute("playsinline",
"true");a.shouldDisableControls||c.setAttribute("controls","true");a.shouldAutoplay&&c.setAttribute("autoplay","true");a.shouldStartMuted&&c.setAttribute("muted","true");d.appendChild(c);var h=this;b.embedPromise(e,a,{player:{techOrder:a.twitchCore?["TwitchWhiteLabel","html5"]:["html5"]}}).then(function(d){h.videoJS=d;document.getElementById(e).setAttribute("style","width:100%; height:100%;");h.videoJS.poster(a.posterSource);h.videoJS.aspectRatio("16:9");h.videoJS.src(a.mediaSourceInfo[0]);h.vseMetrics=
b.metrics(h.videoJS);a.videoAds&&a.videoAds.isEngineEnabled&&(h.vseAds=b.ads(h.videoJS));h.videoJS.on("ended",function(){h.eventHandlers.onPlaybackComplete()});h.videoJS.on("playing",function(){h.eventHandlers.onPlaybackStart()});h.eventEmitter.emit("playerLoaded")})}a.prototype.play=function(b){!b||this.currentAsset&&b.contentId==this.currentAsset.contentId||(this.videoJS.poster(b.imageUrl),this.videoJS.posterImage.show(),this.vseMetrics.setContentId&&this.vseMetrics.setContentId(b.contentId),this.vseMetrics.setRefTag&&
this.vseMetrics.setRefTag(b.refTag?b.refTag:""),this.vseAds&&(this.vseAds.setContentId(b.contentId),this.vseAds.setVendorCode(b.vendorCode)),this.videoJS.src(b.videoUrl),this.currentAsset=b);b=b&&b.eventTimestamp?b.eventTimestamp:Date.now();this.vseMetrics.setPageLoadStartTimestamp(b);return this.videoJS.play()};a.prototype.muted=function(b){return this.videoJS.muted(b)};a.prototype.mute=function(){this.videoJS.muted(!0)};a.prototype.unmute=function(){this.videoJS.muted(!1)};a.prototype.isMuted=function(){return this.videoJS.muted()};
a.prototype.getCurrentTime=function(){return this.videoJS.currentTime()};a.prototype.setCurrentTime=function(b){this.videoJS.currentTime(b)};a.prototype.pause=function(){this.videoJS.pause();return this};a.prototype.resume=function(b){this.videoJS.play();return this};a.prototype.seek=function(b){this.videoJS.currentTime(b);return this};a.prototype.stop=function(){this.videoJS.pause();this.currentAsset=q;return this};a.prototype.on=function(b,a){this.eventEmitter.on(b,a);return this};a.prototype.off=
function(b,a){return this};a.prototype.onTime=function(b,a,d){return this};a.prototype.offTime=function(b,a,d){return this};a.prototype.onAd=function(b,a){return this};a.prototype.offAd=function(b,a){return this};a.prototype.getCurrent=function(){return this.currentAsset};a.prototype.getPosition=function(){return this.videoJS.currentTime()};a.prototype.isPlaying=function(){return!this.videoJS.paused()};a.prototype.isPaused=function(){return this.videoJS.paused()};a.prototype.getVersion=function(){return"VJS"};
a.prototype.getFlashVersion=function(){return""};a.prototype.getRendererType=function(){return""};a.prototype.destroy=function(){this.vseMetrics.publishBeforeDispose();this.videoJS.off("ended",this.eventHandlers.onPlaybackComplete);this.videoJS.dispose();this.videoJS=null};a.prototype.initHandlers=function(){var b=this;this.eventHandlers={onPlaybackComplete:function(){return b.player_onPlaybackComplete()},onPlaybackStart:function(){return b.player_onPlaybackStart()}}};a.prototype.player_onPlaybackComplete=
function(){if(!this.vseAds||!this.vseAds.isAdPlaying()){var b=this.currentAsset;this.currentAsset=q;b&&(b.eventTimestamp=Date.now());this.eventEmitter.emit("playbackComplete",b)}};a.prototype.player_onPlaybackStart=function(){this.currentAsset&&(this.currentAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackStart",this.currentAsset)};return a}(),Y=function(){function a(b,a){var d=this;this.libs=a;this.commands=[];b.then(function(b){d.playerInstance=b;d.executeCommands()})}a.prototype.executeCommands=
function(){for(var b=0;b<this.commands.length;b++)this.commands[b](this.playerInstance)};a.prototype.play=function(b){var a=this;this.playerInstance?this._play(b,this.playerInstance):this.commands.push(function(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];return a._play(b,d[0])});return this};a.prototype.mute=function(){var b=this;this.playerInstance?this._mute(this.playerInstance):this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._mute(a[0])})};
a.prototype.unmute=function(){var b=this;this.playerInstance?this._unmute(this.playerInstance):this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._unmute(a[0])})};a.prototype.isMuted=function(){var b=this;if(this.playerInstance)return this._isMuted(this.playerInstance);this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._isMuted(a[0])});return!0};a.prototype.getCurrentTime=function(){var b=this;if(this.playerInstance)return this._getCurrentTime(this.playerInstance);
this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._getCurrentTime(a[0])});return 0};a.prototype.setCurrentTime=function(b){var a=this;this.playerInstance?this._setCurrentTime(b,this.playerInstance):this.commands.push(function(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];return a._setCurrentTime(b,d[0])})};a.prototype.pause=function(){var b=this;this.playerInstance?this._pause(this.playerInstance):this.commands.push(function(){for(var a=
[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._pause(a[0])});return this};a.prototype.resume=function(b){var a=this;this.playerInstance?this._resume(b,this.playerInstance):this.commands.push(function(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];return a._resume(b,d[0])});return this};a.prototype.stop=function(){var b=this;this.playerInstance?this._stop(this.playerInstance):this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._stop(a[0])});
return this};a.prototype.seek=function(b){var a=this;this.playerInstance?this._seek(b,this.playerInstance):this.commands.push(function(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];return a._seek(b,d[0])});return this};a.prototype.on=function(b,a){var d=this;this.playerInstance?this._on(b,a,this.playerInstance):this.commands.push(function(){for(var c=[],e=0;e<arguments.length;e++)c[e]=arguments[e];return d._on(b,a,c[0])});return this};a.prototype.off=function(b,a){var d=this;this.playerInstance?
this._off(b,a,this.playerInstance):this.commands.push(function(){for(var c=[],e=0;e<arguments.length;e++)c[e]=arguments[e];return d._off(b,a,c[0])});return this};a.prototype.onTime=function(b,a,d){var c=this;this.playerInstance?this._onTime(b,a,d,this.playerInstance):this.commands.push(function(){for(var e=[],h=0;h<arguments.length;h++)e[h]=arguments[h];return c._onTime(b,a,d,e[0])});return this};a.prototype.offTime=function(b,a,d){var c=this;this.playerInstance?this._offTime(b,a,d,this.playerInstance):
this.commands.push(function(){for(var e=[],h=0;h<arguments.length;h++)e[h]=arguments[h];return c._offTime(b,a,d,e[0])});return this};a.prototype.onAd=function(b,a){var d=this;this.playerInstance?this._onAd(b,a,this.playerInstance):this.commands.push(function(){for(var c=[],e=0;e<arguments.length;e++)c[e]=arguments[e];return d._onAd(b,a,c[0])});return this};a.prototype.offAd=function(b,a){var d=this;this.playerInstance?this._offAd(b,a,this.playerInstance):this.commands.push(function(){for(var c=[],
e=0;e<arguments.length;e++)c[e]=arguments[e];return d._offAd(b,a,c[0])});return this};a.prototype.getCurrent=function(){if(this.playerInstance)return this.playerInstance.getCurrent()};a.prototype.getPosition=function(){return this.playerInstance?this.playerInstance.getPosition():0};a.prototype.isPlaying=function(){return this.playerInstance?this.playerInstance.isPlaying():!1};a.prototype.isPaused=function(){return this.playerInstance?this.playerInstance.isPaused():!1};a.prototype.getVersion=function(){return this.playerInstance?
this.playerInstance.getVersion():""};a.prototype.getFlashVersion=function(){return this.playerInstance?this.playerInstance.getFlashVersion():""};a.prototype.getRendererType=function(){return this.playerInstance?this.playerInstance.getRendererType():""};a.prototype.destroy=function(){this.playerInstance&&this.playerInstance.destroy();this.playerInstance=null};a.prototype._play=function(b,a){b?a.play(b):a.play()};a.prototype._mute=function(b){b.mute()};a.prototype._unmute=function(b){b.unmute()};a.prototype._isMuted=
function(b){return b.isMuted()};a.prototype._getCurrentTime=function(b){return b.getCurrentTime()};a.prototype._setCurrentTime=function(b,a){a.setCurrentTime(b)};a.prototype._pause=function(b){b.pause()};a.prototype._stop=function(b){b.stop()};a.prototype._resume=function(b,a){a.resume(b)};a.prototype._seek=function(b,a){a.seek(b)};a.prototype._on=function(b,a,d){d.on(b,a)};a.prototype._off=function(b,a,d){d.off(b,a)};a.prototype._onTime=function(b,a,d,c){c.onTime(b,a,d)};a.prototype._offTime=function(b,
a,d,c){c.offTime(b,a,d)};a.prototype._onAd=function(b,a,d){d.onAd(b,a)};a.prototype._offAd=function(b,a,d){d.offAd(b,a)};a.prototype._destroy=function(b){b.destroy()};return a}(),L=function(){function a(b){this.deps=b}a.prototype.create=function(b){var a=this,d=w(),c=new this.deps.promise(function(b,a){g[d]={resolve:b,reject:a}});t.when("brila").execute("construct-player",function(b){g[d].resolve(b)});var e=document.getElementById(b.containerId),h=b.containerId+"-container";e.innerHTML='\x3cdiv id\x3d"'+
h+'" style\x3d"width:100%; height:100%"\x3e\x3c/div\x3e';e=(new this.deps.promise(function(d,e){c.then(function(c){var e=new X(c,U(b,h),b.initialVideo,a.deps);e.on("playerLoaded",function(){d(e)})})})).then(function(b){return b});return new W(new Y(e,this.deps),document.getElementById(h),this.deps)};return a}(),Z=function(){function a(b,a){void 0===a&&(a={refTagRecorderEndPoint:"/gp/mobile/tag/",retryLimit:3});this.A=b;this.config=a}a.prototype.emitRefTag=function(b,a,d){void 0===d&&(d=0);if(!(d>=
this.config.retryLimit)){var c=this;this.A.post(this.config.refTagRecorderEndPoint+"ref\x3d"+b+(a.enableAssociateTag?"?tag\x3dospatk-20\x26linkCode\x3dvse\x26creativeASIN\x3d"+a.productAsin+"\x26ascsubtag\x3d"+a.contentId:""),{error:function(){c.emitRefTag(b,a,++d)}})}};return a}(),k=function(){function a(){}a.POSITIVE_VOTE="positive";a.NEGATIVE_VOTE="negative";a.NONE_VOTE="none";a.EMPTY_STRING="";a.DEFAULT_MIN_GUTTER=24;a.DEFAULT_HEIGHT_ANIMATION_SPEED=200;a.ATTR_ANIMATING="animating";a.ATTR_CURRENT_GUTTER=
"currentGutter";a.ATTR_FIRST_ITEM_FLUSH_LEFT="first_item_flush_left";a.ATTR_FIRST_VISIBLE_ITEM="firstVisibleItem";a.ATTR_HEIGHT_ANIMATION_SPEED="height_animation_speed";a.ATTR_HIDE_OFFSCREEN="hide_off_screen";a.ATTR_MAX_HEIGHT="maxHeight";a.ATTR_MIN_GUTTER="minimum_gutter_width";a.ATTR_PAGE_NUMBER="pageNumber";a.ATTR_PAGE_SIZE="pageSize";a.ATTR_SET_SIZE="set_size";a.ATTR_SHOW_PARTIAL="show_partial_next";a.ATTR_SINGLE_PAGE_ALIGN="single_page_align";a.ATTR_TOTAL_PAGES="totalPages";a.FIRST_PAGE="first-page";
a.LAST_PAGE="last-page";a.$VSE_DISPLAY_STRATEGY_ELEMENT=".a-carousel-display-vse";return a}(),E=function(){function a(b,a){this.element=b;this.videoVoteConfig=a;this.countsFetched=!1;this.positiveVoteCount=0;this.showPositiveVotes=!1;this.negativeVoteCount=0;this.showNegativeVotes=!1;this.prompt=b.find(".vse-vote-helpful-text");this.positiveVoteText=b.find(".vse-vote-positive");this.positiveVoteIcon=b.find(".vse-vote-positive-icon");this.negativeVoteText=b.find(".vse-vote-negative");this.negativeVoteIcon=
b.find(".vse-vote-negative-icon");this.previousVote=k.EMPTY_STRING}a.prototype.getVoteCount=function(b){return b===k.POSITIVE_VOTE?this.positiveVoteCount:b===k.NEGATIVE_VOTE?this.negativeVoteCount:0};a.prototype.setVoteCount=function(b,a){0>a&&(a=0);b===k.POSITIVE_VOTE?(this.positiveVoteCount=a,this.positiveVoteText.html(String(a))):b===k.NEGATIVE_VOTE&&(this.negativeVoteCount=a,this.negativeVoteText.html(String(a)));this.element.addClass("updated")};a.prototype.getPreviousVote=function(){return this.previousVote};
a.prototype.setPreviousVote=function(b){if(b===k.POSITIVE_VOTE)this.positiveVoteIcon.addClass("hasvoted"),this.negativeVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(k.POSITIVE_VOTE)&&this.setVoteCount(k.POSITIVE_VOTE,1);else if(b===k.NEGATIVE_VOTE)this.negativeVoteIcon.addClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(k.NEGATIVE_VOTE)&&this.setVoteCount(k.NEGATIVE_VOTE,1);else if(b===k.NONE_VOTE)this.negativeVoteIcon.removeClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted");
else return;this.previousVote=b};a.prototype.setContentId=function(b){this.contentId=b};a.prototype.getContentId=function(){return this.contentId};a.prototype.showOrHide=function(b,a,d,c){this.showPositiveVotes=b;this.showNegativeVotes=a;this.showPrompt=d;b?(this.positiveVoteText.addClass("show"),this.positiveVoteIcon.addClass("show")):(this.positiveVoteText.removeClass("show"),this.positiveVoteIcon.removeClass("show"));a?(this.negativeVoteText.addClass("show"),this.negativeVoteIcon.addClass("show")):
(this.negativeVoteText.removeClass("show"),this.negativeVoteIcon.removeClass("show"));d?this.prompt.addClass("show"):this.prompt.removeClass("show");c?this.element.addClass("show"):this.element.removeClass("show")};a.prototype.updateWithNewVote=function(b){if(b===k.POSITIVE_VOTE||b===k.NEGATIVE_VOTE){var a=b==k.POSITIVE_VOTE?k.NEGATIVE_VOTE:k.POSITIVE_VOTE,d=this.getVoteCount(b),c=this.getVoteCount(a);b===this.getPreviousVote()?(this.setPreviousVote(k.NONE_VOTE),this.setVoteCount(b,d-1)):this.getPreviousVote()!==
k.EMPTY_STRING&&this.getPreviousVote()!==k.NONE_VOTE?(this.setVoteCount(a,c-1),this.setVoteCount(b,d+1),this.setPreviousVote(b)):(this.setPreviousVote(b),this.setVoteCount(b,d+1))}};return a}(),G=function(){return function(a,b,f){this.contentId=a;this.positiveVoteCount=b;this.negativeVoteCount=f}}(),M=function(){return function(a){this.name="InvalidArugmentsException";this.message=a}}(),I=function(){function a(b,a){this.A=b;this.videoVoteConfig=a}a.prototype.createFromContent=function(b,a){b=this.A.$("#"+
b).find('[.vse-video-votes][data-contentid\x3d"'+a+'"]');return new E(b,this.videoVoteConfig)};a.prototype.createFromSelector=function(b){var a=this.A.$(""+b);if(!a)throw new M("VideoVoteContainerFactory can not find selector by the name of "+b+".");return new E(a,this.videoVoteConfig)};a.prototype.sendVoteToRemote=function(b,a,d){var c=this,e=null,h=!1;this.videoVoteConfig.forceTreatment&&(e=[{name:"VSE_VIDEOVOTES_IMAGE_BLOCK_195012",assignment:"T1"}],h=!0);var p={contentId:d,placement:this.videoVoteConfig.placementContext,
positive:b,negative:a,requestId:this.videoVoteConfig.requestId,sessionId:this.videoVoteConfig.sessionId,page:this.videoVoteConfig.page,experimentWeblab:this.videoVoteConfig.experimentWeblab,weblabContext:e,bypassLogin:h};return new this.videoVoteConfig.dependencies.promise(function(b,a){c.A.ajax("/vap/ew/subcomponent/votes/writing",{params:p,paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(a){b(a)},error:function(b){v.count("votecast:failed",1);a(b)}})})};
a.prototype.fetchVoteHistory=function(b){var a=this,d=null,c=!1;this.videoVoteConfig.forceTreatment&&(d=[{name:"VSE_VIDEOVOTES_IMAGE_BLOCK_195012",assignment:"T1"}],c=!0);var e={contentId:b,placement:this.videoVoteConfig.placementContext,requestId:this.videoVoteConfig.requestId,sessionId:this.videoVoteConfig.sessionId,page:this.videoVoteConfig.page,experimentWeblab:this.videoVoteConfig.experimentWeblab,weblabContext:d,bypassLogin:c};return new this.videoVoteConfig.dependencies.promise(function(b,
d){a.A.ajax("/vap/ew/subcomponent/votes/status",{params:e,paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(a){b(a)},error:function(b){v.count("votehistory:failed",1);d(b)}})})};a.prototype.convertPayloadToVoteData=function(b){var a=[],d;for(d in b)b.hasOwnProperty(d)&&a.push(new G(d,b[d].positive,b[d].negative));return a};a.prototype.fetchVoteCounts=function(b){var a=this,d=null,c=!1;this.videoVoteConfig.forceTreatment&&(d=[{name:"VSE_VIDEOVOTES_IMAGE_BLOCK_195012",
assignment:"T1"}],c=!0);var e={contentIds:b,placement:this.videoVoteConfig.placementContext,requestId:this.videoVoteConfig.requestId,sessionId:this.videoVoteConfig.sessionId,page:this.videoVoteConfig.page,experimentWeblab:this.videoVoteConfig.experimentWeblab,weblabContext:d,bypassLogin:c};return new this.videoVoteConfig.dependencies.promise(function(b,d){a.A.ajax("/vap/ew/subcomponent/votes",{params:e,paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(c){c=
a.convertPayloadToVoteData(c);0<c.length&&b(c);d(c)},error:function(b){v.count("votegetcounts:failed",1);d(b)}})})};return a}(),aa=function(){function a(b,a,d,c,e){var h=this;this.carouselFramework=a;this.A=d;this.contentCarouselConfig=c;this.deps=e;this.vseAssets=[];this.vseAssetIndex={};this.voteContainerIndex={};this.carouselPageSize=this.carouselTotalPages=0;this.carouselPageNumber=1;this.getplaylist=function(){return h.vseAssets.slice()};this.getActiveAsset=function(){return h.activeAsset};this.scrollTo=
function(){h.A.$("#"+h.contentCarouselConfig.carouselName).animate({scrollTop:h.activeCard.offset().top-h.A.$("#"+h.contentCarouselConfig.carouselName).offset().top+h.A.$("#"+h.contentCarouselConfig.carouselName).scrollTop()})};this.rotateTo=function(b){h.markPlaying(b);h.contentCarouselConfig.isVerticalScroll&&h.scrollTo();0!==h.carouselPageSize&&(b=h.findIndex(b),-1!==b&&(b=Math.floor(b/h.carouselPageSize)+1,h.carouselPageNumber!=b&&h.auiCarousel.gotoPage(b)))};this.markPlaying=function(b){h.activeAsset=
b;h.activeCard.removeClass("active");h.activeCard=h.vseAssetIndex[b.contentId].$el.closest("li").addClass("active")};this.findIndex=function(b){return h.vseAssets.indexOf(h.vseAssetIndex[b.contentId])};this.emitRefTag=function(b,a,c){0<h.listOffset&&(b=(b-h.listOffset+h.vseAssets.length)%h.vseAssets.length);h.refTagRecorder.emitRefTag(a+b,c)};this.destroy=function(){h.A.$("#"+h.contentCarouselConfig.carouselName+" .a-carousel-card.active").removeClass("active")};this.updateVotingElements=function(b,
a){h.A.each(b,function(b){var c=h.vseAssetIndex[b.contentId].videoVoteContainer;c.setVoteCount(k.POSITIVE_VOTE,b.positiveVoteCount);c.setVoteCount(k.NEGATIVE_VOTE,b.negativeVoteCount);c.countsFetched=!0;c.showOrHide(a,a,!1,a)})};this.getAssetSpec=function(b,a,c){var f=b.data(),d=b.find(".vse-video-image").data("img"),d=d.replace("SR160,90_BG0,0,0_PKvse-overlay-play2","").replace("SR320,180_BG0,0,0_PKvse-overlay-play2","");return{contentId:f.asin,title:f.title,vendorName:f.vendorName,vendorCode:f.vendorCode,
referenceUrl:f.referenceUrl,referenceLinkTitle:f.referenceTitle,videoUrl:f.videoUrl,$el:b,duration:f.duration,imageUrl:d,sponsored:f.sponsored,enableAssociateTag:f.enableAssociateTag,videoVoteContainer:h.voteContainerIndex[f.asin],productAsin:f.productAsin,refTag:c+a,relatedProducts:f.relatedProducts}};var p=d.$;this.activeCard=p([]);var x=this;this.auiCarousel=b;this.refTagRecorder=new Z(d);p("#"+c.carouselName).find(".a-carousel-heading").after(p("#"+c.carouselName).find(".vse-upload-link").removeClass("aok-hidden"));
p("#"+c.carouselName+" .vse-video-item").each(function(b){b=x.getAssetSpec(p(this),b,x.contentCarouselConfig.refTagPrefix);x.vseAssets.push(b);x.vseAssetIndex[b.contentId]=b});c.showVideoVotes&&c.videoVoteConfig&&(this.videoVoteContainerFactory=new I(d,c.videoVoteConfig),d.each(this.vseAssetIndex,function(b){h.voteContainerIndex[b.contentId]=h.videoVoteContainerFactory.createFromContent(h.contentCarouselConfig.carouselName,b.contentId);b.videoVoteContainer=h.voteContainerIndex[b.contentId]}));c.showAdPlacement||
p("#"+c.carouselName).delegate(".a-carousel-card a","click",function(b){if(p(this).closest("li").hasClass("active"))b.preventDefault();else{var a=x.vseAssetIndex[p(this).closest("li").find(".vse-video-item").data("asin")];x.markPlaying(a);a.eventTimestamp=Date.now();d.trigger("vse:contentCarousel:"+c.carouselName+":click",a);var f=x.findIndex(a);x.emitRefTag(f,x.contentCarouselConfig.refTagPrefix,a);c.isPreventDefault&&b.preventDefault()}});p("#"+c.carouselName+" .vse-carousel-item").each(function(b){var a=
p(this);if(c.showAdPlacement){a.attr("href",a.data("redirect-url")+"?ref\x3ddp_vse_rva1_pc");var f=a.parent().data("asin");a.parent().delegate(".vse-carousel-item","click",function(b){d.trigger("vse:rva:carousel:"+c.carouselName+":productClick",{relatedProductAsin:f,name:"vse.related_video_advertising.productClick"})})}else a.attr("href",a.data("redirect-url")+"?ref\x3d"+x.contentCarouselConfig.refTagPrefix+b)});d.off("a:carousel:"+c.carouselName+":change:pageSize");d.off("a:carousel:"+c.carouselName+
":change:pageNumber");d.on("a:carousel:"+c.carouselName+":change:pageSize",function(){h.carouselPageSize=h.auiCarousel.getAttr("pageSize");h.activeAsset&&h.rotateTo(h.activeAsset)});d.trigger("a:carousel:"+c.carouselName+":change:pageSize");d.on("a:carousel:"+c.carouselName+":change:pageNumber",function(b){var a=b.carousel;b=b.newValue;var f=a.getAttr("totalPages");a.dom.$carousel.closest(k.$VSE_DISPLAY_STRATEGY_ELEMENT).toggleClass(k.FIRST_PAGE,1===b);a.dom.$carousel.closest(k.$VSE_DISPLAY_STRATEGY_ELEMENT).toggleClass(k.LAST_PAGE,
b===f);h.carouselPageNumber=h.auiCarousel.getAttr("pageNumber");d.trigger("a:carousel:"+c.carouselName+":scrollCarousel",h.carouselPageNumber,h.carouselPageSize)});d.trigger("a:carousel:"+c.carouselName+":updatePageIndex",this.carouselPageNumber,this.carouselPageSize);d.declarative(c.carouselName+"-sm-link","click touch",function(b){p("#"+c.carouselName+" .vse-video-item .vse-carousel-item").first().click()})}a.prototype.changeStartingCardTo=function(b){var a=this;this.listOffset=this.findIndex(b);
var c=this;this.A.$("#"+this.contentCarouselConfig.carouselName+" .vse-carousel-item").each(function(b){var a=c.A.$(this);b=(b-c.listOffset+c.vseAssets.length)%c.vseAssets.length;a.attr("href",a.data("redirect-url")+"?ref\x3d"+c.contentCarouselConfig.refTagPrefix+b)});this.contentCarouselConfig.isVerticalScroll||(this.carouselFramework.initializeAll(),this.carouselFramework.onInit(""+this.contentCarouselConfig.carouselName,function(){a.rotateTo(b)}))};return a}(),ba=function(){function a(b,a,c){this.carouselFramework=
b;this.A=a;this.deps=c}a.prototype.create=function(b){var a=this.carouselFramework.getCarousel(this.A.$("#"+b.carouselName));if(!a)throw new M("Carousel framework can not find carousel by the name of "+b.carouselName+".");return new aa(a,this.carouselFramework,this.A,b,this.deps)};return a}(),N=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a){function b(){}function c(b,a,f){this.fn=b;this.context=a;this.once=f||!1}function d(){this._events=new b;this._eventsCount=0}var y=
Object.prototype.hasOwnProperty,e="~";Object.create&&(b.prototype=Object.create(null),(new b).__proto__||(e=!1));d.prototype.eventNames=function(){var b=[],a,c;if(0===this._eventsCount)return b;for(c in a=this._events)y.call(a,c)&&b.push(e?c.slice(1):c);return Object.getOwnPropertySymbols?b.concat(Object.getOwnPropertySymbols(a)):b};d.prototype.listeners=function(b,a){b=this._events[e?e+b:b];if(a)return!!b;if(!b)return[];if(b.fn)return[b.fn];a=0;for(var c=b.length,f=Array(c);a<c;a++)f[a]=b[a].fn;
return f};d.prototype.emit=function(b,a,c,f,d,y){var m=e?e+b:b;if(!this._events[m])return!1;var m=this._events[m],k=arguments.length,l,g;if(m.fn){m.once&&this.removeListener(b,m.fn,q,!0);switch(k){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,a),!0;case 3:return m.fn.call(m.context,a,c),!0;case 4:return m.fn.call(m.context,a,c,f),!0;case 5:return m.fn.call(m.context,a,c,f,d),!0;case 6:return m.fn.call(m.context,a,c,f,d,y),!0}g=1;for(l=Array(k-1);g<k;g++)l[g-1]=arguments[g];
m.fn.apply(m.context,l)}else{var r=m.length,n;for(g=0;g<r;g++)switch(m[g].once&&this.removeListener(b,m[g].fn,q,!0),k){case 1:m[g].fn.call(m[g].context);break;case 2:m[g].fn.call(m[g].context,a);break;case 3:m[g].fn.call(m[g].context,a,c);break;case 4:m[g].fn.call(m[g].context,a,c,f);break;default:if(!l)for(n=1,l=Array(k-1);n<k;n++)l[n-1]=arguments[n];m[g].fn.apply(m[g].context,l)}}return!0};d.prototype.on=function(b,a,d){a=new c(a,d||this);b=e?e+b:b;this._events[b]?this._events[b].fn?this._events[b]=
[this._events[b],a]:this._events[b].push(a):(this._events[b]=a,this._eventsCount++);return this};d.prototype.once=function(b,a,d){a=new c(a,d||this,!0);b=e?e+b:b;this._events[b]?this._events[b].fn?this._events[b]=[this._events[b],a]:this._events[b].push(a):(this._events[b]=a,this._eventsCount++);return this};d.prototype.removeListener=function(a,c,f,d){a=e?e+a:a;if(!this._events[a])return this;if(!c)return 0===--this._eventsCount?this._events=new b:delete this._events[a],this;var g=this._events[a];
if(g.fn)g.fn!==c||d&&!g.once||f&&g.context!==f||(0===--this._eventsCount?this._events=new b:delete this._events[a]);else{for(var y=0,k=[],l=g.length;y<l;y++)(g[y].fn!==c||d&&!g[y].once||f&&g[y].context!==f)&&k.push(g[y]);k.length?this._events[a]=1===k.length?k[0]:k:0===--this._eventsCount?this._events=new b:delete this._events[a]}return this};d.prototype.removeAllListeners=function(a){a?(a=e?e+a:a,this._events[a]&&(0===--this._eventsCount?this._events=new b:delete this._events[a])):(this._events=
new b,this._eventsCount=0);return this};d.prototype.off=d.prototype.removeListener;d.prototype.addListener=d.prototype.on;d.prototype.setMaxListeners=function(){return this};d.prefixed=e;d.EventEmitter=d;"undefined"!==typeof a&&(a.exports=d)}).EventEmitter,r=function(){function a(){}a.cacheRelatedProductsPayloadHiddenDivId="#vse-related-products-cache-hidden";a.visibleDivNarrowPrefix="vse-pc-visible-narrow-";a.visibleDivWidePrefix="vse-pc-visible-wide-";a.narrowContainerSelector="#vse-related-products-narrow";
a.narrowContainerMobileSelector="#vse-related-products-narrow-mobile";a.wideContainerSelector="#vse-related-products-wide";a.relatedProductsInnerContainer=".vse-related-product-container";a.activeProductCarousel=".vse-pc-visible";return a}(),ca=function(){function a(b,a,c,g,e,h,p,l,u,n,q){var m=this;this.wrapper=b;this.useSecondaryView=a;this.$=c;this.A=g;this.productCarouselId=e;this.showRelatedProducts=h;this.customerReviewPrefix=p;this.useVerticalLayout=l;this.showVideoVotes=u;this.carouselFramework=
n;this.videoVoteContainerFactory=q;this.prefixes=["","Customer Review: "];this.videoVoteFailure=!1;this.relatedProductsContainerFixedHeight=115;this.useNarrowContainer=!1;this.verticalLightboxMaxWidth=1024;this.carouselFramework=n;this.title=this.wrapper.find(".vse-content-title");this.titlePrefix=this.wrapper.find(".vse-content-title-prefix");this.referenceLink=this.wrapper.find("#vse-customer-review-link");this.activeVideoTitle=this.wrapper.find(".vse-active-video-heading");this.activeVideoTitlePrefix=
this.wrapper.find("#vse-activevideo-crv-prefix");this.activeVideoReferenceLink=this.wrapper.find("#vse-activevideo-crv-link");this.activeVideoVendorName=this.wrapper.find(".vse-video-author");this.lbVideoCarousel=this.wrapper.find(".vse-related-videos-container");this.lbVideoCarouselContainer=this.wrapper.find(".vse-lb-right");this.mobileFixedContainer=this.wrapper.find(".vse-lb-left");this.lbHeaderElement=this.wrapper.find(".vse-lb-back-button");this.prefixes[1]=p+": ";this.activeVideoCustomerProfile=
this.wrapper.find("#vse-active-video-customer-profile");this.customerProfileFeedbackContainer=this.wrapper.find(".vse-cp-fb-container");this.narrowContainerSelector=this.wrapper.find(r.narrowContainerSelector);this.wideContainerSelector=this.wrapper.find(r.wideContainerSelector);this.showVideoVotes&&this.videoVoteContainerFactory&&this.videoVoteContainerFactory.videoVoteConfig&&(this.activeVideoVoteContainer=this.videoVoteContainerFactory.createFromSelector("#vse-video-votes-lb-details-"+this.videoVoteContainerFactory.videoVoteConfig.placementContext));
this.lbContainer=this.wrapper.find(".vse-lb-container");this.lbLeftColumnn=this.wrapper.find(".vse-lb-left");this.lbRightColumnn=this.wrapper.find(".related-videos-section");this.lbCCHeader=this.wrapper.find(".vse-cc-header");this.lbTabContainer=this.wrapper.find(".vse-lightbox-tab");this.videoAuthor=this.wrapper.find(".vse-video-author span");g.on("resize",function(){a?m.resizeMobileLB():m.resizeDesktopLB()});this.showVideoVotes&&q&&q.videoVoteConfig&&(this.A.on(q.videoVoteConfig.actionPrefix+"-hide-votes",
function(){m.activeVideoVoteContainer.showOrHide(!1,!1,!1,!1);m.videoVoteFailure=!0}),this.A.declarative(q.videoVoteConfig.actionPrefix+"-vote-positive","click",function(){m.castVote(k.POSITIVE_VOTE)}),this.A.declarative(q.videoVoteConfig.actionPrefix+"-vote-negative","click",function(){m.castVote(k.NEGATIVE_VOTE)}))}a.prototype.castVote=function(b){var a=this;if(this.showVideoVotes&&this.videoVoteContainerFactory&&this.videoVoteContainerFactory.videoVoteConfig){var c=this.activeVideoVoteContainer.getPreviousVote(),
g=b===k.POSITIVE_VOTE&&c!=k.POSITIVE_VOTE,c=b===k.NEGATIVE_VOTE&&c!=k.NEGATIVE_VOTE;this.activeVideoVoteContainer.updateWithNewVote(b);this.videoVoteContainerFactory.sendVoteToRemote(g,c,this.activeVideoVoteContainer.getContentId()).then(function(c){a.videoVoteContainerFactory&&a.videoVoteContainerFactory.videoVoteConfig&&a.A.trigger(a.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast",b)},function(c){a.activeVideoVoteContainer.updateWithNewVote(b)})}};a.prototype.update=function(b,
a){this.updateActiveVideo(b);this.updateTitle(b,a)};a.prototype.updateActiveVideo=function(b){var a=this,c=this._isCustomerReviewVideo(b);this.activeVideoTitle.text(b.title);this.activeVideoVendorName.text(b.vendorName);var g=this.lbVideoCarousel.find('[data-asin\x3d"'+b.contentId+'"]').find(".vse-video-customer-profile");0<g.length?(this.activeVideoCustomerProfile.html(g.clone().removeClass("vse-hidden").html()),this.activeVideoVendorName.addClass("vse-hidden"),this.customerProfileFeedbackContainer.removeClass("vse-no-cp")):
(this.activeVideoCustomerProfile.html(""),this.activeVideoVendorName.removeClass("vse-hidden"),this.customerProfileFeedbackContainer.addClass("vse-no-cp"));this.activeVideoTitlePrefix.text(this.prefixes[+c]);this.activeVideoReferenceLink.attr("href",b.referenceUrl||"");this.activeVideoReferenceLink.text(b.title);c?(this.activeVideoReferenceLink.text("Customer Review: "+b.title),this.activeVideoTitle.addClass("vse-invisible"),this.activeVideoReferenceLink.removeClass("vse-invisible")):(this.activeVideoTitle.removeClass("vse-invisible"),
this.activeVideoReferenceLink.addClass("vse-invisible"));this.showVideoVotes&&this.videoVoteContainerFactory&&this.videoVoteContainerFactory.videoVoteConfig&&!this.videoVoteFailure&&(this.updateActiveVideoVoteContainer(b.contentId,b.videoVoteContainer.getVoteCount(k.POSITIVE_VOTE),b.videoVoteContainer.getVoteCount(k.NEGATIVE_VOTE),b.videoVoteContainer.countsFetched),this.activeVideoVoteContainer.countsFetched||this.videoVoteContainerFactory.fetchVoteCounts([b.contentId]).then(function(c){a.videoVoteContainerFactory!==
q&&0<c.length&&c[0].contentId===b.contentId&&(a.A.trigger(a.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-counts-fetched",c),a.updateActiveVideoVoteContainer(c[0].contentId,c[0].positiveVoteCount,c[0].negativeVoteCount,!0))},function(b){a.videoVoteContainerFactory!==q&&a.A.trigger(a.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-hide-votes")}),b.videoVoteContainer.getPreviousVote()!==k.EMPTY_STRING?this.activeVideoVoteContainer.setPreviousVote(b.videoVoteContainer.getPreviousVote()):
this.videoVoteContainerFactory.fetchVoteHistory(b.contentId).then(function(b){a.videoVoteContainerFactory===q||b!==k.POSITIVE_VOTE&&b!==k.NEGATIVE_VOTE&&b!==k.NONE_VOTE||(a.activeVideoVoteContainer.setPreviousVote(b),a.A.trigger(a.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-history-set",b))},function(b){}),this.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0));this.useSecondaryView&&this.resizeMobileLB()};a.prototype.updateActiveVideoVoteContainer=function(b,a,c,g){this.activeVideoVoteContainer.setContentId(b);
this.activeVideoVoteContainer.setVoteCount(k.POSITIVE_VOTE,a);this.activeVideoVoteContainer.setVoteCount(k.NEGATIVE_VOTE,c);this.activeVideoVoteContainer.countsFetched=g};a.prototype.updateTitle=function(b,a){this.title=this.$(".vse-content-title");this.title.text(b.title);this.videoAuthor.text(b.vendorName);this.title.attr("title",b.title);this.titlePrefix=this.$(".vse-content-title-prefix");this.titlePrefix.text(this.prefixes[+this._isCustomerReviewVideo(b)]);a=this._isCustomerReviewVideo(b);this.referenceLink.attr("href",
b.referenceUrl||"");this.referenceLink.text(b.referenceLinkTitle||"");a?(this.referenceLink.removeClass("vse-invisible"),this.referenceLink.closest(".vse-video-title").removeClass("vse-no-cr")):(this.referenceLink.addClass("vse-invisible"),this.referenceLink.closest(".vse-video-title").addClass("vse-no-cr"));this.useSecondaryView?this.resizeMobileLB():this.resizeDesktopLB()};a.prototype.resizeDesktopLB=function(){var b=this.lbLeftColumnn.outerHeight(!0),a=this.narrowContainerSelector.height(),c=this.useNarrowRelatedProductsContainer(b-
a),g=0;0==a&&(g=this.relatedProductsContainerFixedHeight);a=b+g-this.lbCCHeader.outerHeight(!0);this.lbContainer.height(b+this.lbTabContainer.outerHeight(!0)+g);this.lbRightColumnn.find(".vse-vertical-scroll").css({"max-height":a});this.$(".vse-lightbox-player-container video").removeClass("dim-video-player");this.showRelatedProducts&&this.adjustRelatedProductsContainer(c)};a.prototype.useNarrowRelatedProductsContainer=function(b){var a=this.wrapper.find(".vse-lb-right .related-videos-section .a-carousel-row").height();
return this.showRelatedProducts&&a>b?!0:!1};a.prototype.adjustRelatedProductsContainer=function(b){var a=g.innerWidth;b||a<this.verticalLightboxMaxWidth?(this.showCarouselInNarrowContainer(),this.useNarrowContainer=!0):(this.showCarouselInWideContainer(),this.useNarrowContainer=!1);this.carouselFramework.initializeAll();this.carouselFramework.createAll()};a.prototype.showCarouselInNarrowContainer=function(){this.A.hide(this.wideContainerSelector);this.A.show(this.narrowContainerSelector);var b=this.findNotHiddenProductCarouselId(r.wideContainerSelector);
if(b!==q){var a=b.replace("wide","narrow");this.A.show(this.$("#"+a));this.A.hide(this.$("#"+b));this.$("#"+a+" .vse-related-product-container").addClass("vse-remove-opacity")}};a.prototype.showCarouselInWideContainer=function(){this.A.hide(this.narrowContainerSelector);this.A.show(this.wideContainerSelector);var b=this.findNotHiddenProductCarouselId(r.narrowContainerSelector);if(b!==q){var a=b.replace("narrow","wide");this.A.show(this.$("#"+a));this.A.hide(this.$("#"+b));this.$("#"+a+" .vse-related-product-container").addClass("vse-remove-opacity")}};
a.prototype.findNotHiddenProductCarouselId=function(b){return this.wrapper.find(b).find(r.activeProductCarousel).not(".aok-hidden").attr("id")};a.prototype._isCustomerReviewVideo=function(b){return"AOD60"==b.vendorCode};a.prototype.resizeMobileLB=function(){var b=this.mobileFixedContainer.height(),a=this.$(g).height()-b;this.lbVideoCarouselContainer.css({"max-height":a,top:b});this.lbVideoCarousel.css({"max-height":a-this.lbCCHeader.outerHeight(!0)})};return a}(),B=function(){function a(){}a.ELM_OTHER_OPTION=
".vse-fb-other";a.ELM_RBTN_CHECKED='input[name\x3d"FeedbackInput"]:checked';a.ELM_CHECKBOX_CHECKED='input[type\x3d"checkbox"]:checked';a.DATA_REQ_MSG="requiredcommentmessage";a.DATA_OPTIONAL_MSG="optionalcommentmessage";a.ATTR_NAME_PLACEHOLDER="placeholder";return a}(),O=q,P=q;t.when("a-sheet").execute(function(a){O=a});t.when("a-popover").execute(function(a){P=a});var Q={getBottomSheet:function(){return O},getPopoverFactory:function(){return P}},da=function(){function a(b){var a=this;this.config=
b;this.activeVideoSource=this.activeVideo="VIDEO_NOT_SELECTED";this.isOtherSelected=this.registered=!1;this.setBottomSheetHeight=!0;this.internalRejectedVideo=!1;this.defaultBottomSheetHeight=400;this._submitErrorCallback=function(b){a.A.trigger("vse:"+a.id+":feedback:submitted:error")};this._submitSuccessCallback=function(b){a.A.trigger("vse:"+a.id+":feedback:submitted:success")};this.A=b.A;this.pageStateName=b.pageStateName;this.buttonApi=b.buttonApi;this.id=this.config.id;this.A.state.parse();
this.A.state.replace(this.pageStateName,JSON.parse(this.A.$("script[type\x3d'a-state'][data-a-state*\x3d"+this.pageStateName+"]").html()));b=this.A.state(this.pageStateName);this.feedbackSection=this.A.$("#"+this.id);this.feedbackForm=this.A.$("#"+this.id+"-form");this.commentBox=this.A.$("#"+this.id+"-comment-box");this.requiredCommentMessage=this.commentBox.parent().data(B.DATA_REQ_MSG);this.optionalCommentMessage=this.commentBox.parent().data(B.DATA_OPTIONAL_MSG);this.thankYouSection=this.A.$("#"+
this.id+"-ty-container");this.submitButton=this.buttonApi("#"+this.id+"-btn-submit");this.cancelButton=this.A.$("#"+this.id+"-btn-cancel");b&&this.validateFormElements()&&(this.isMobile=b.isMobile,this.endpoint=b.feedbackEndpoint,this.isInternal=b.isInternal,this.marketplaceId=b.marketplaceId,this.pageAsin=b.pageAsin,this.customerId=b.customerId,this.bottomSheetFactory=Q.getBottomSheet(),this.popoverFactory=Q.getPopoverFactory(),this.registered||(this.A.declarative(this.id+"-options-choose","click",
function(b){a.activeSelectionEvent=b;a.A.$(b)&&a.A.$(b.$target)&&(a.currentViolations=a.A.$(b.$target).closest(".vse-fb-option").find("input").val());a.otherSection=b.$target.closest(B.ELM_OTHER_OPTION);1===a.otherSection.length?(a.updatePlaceholderString(a.requiredCommentMessage),a.isOtherSelected=!0):(a.isOtherSelected=!1,a.updatePlaceholderString(a.optionalCommentMessage));a.submitButton.enable()}),this.A.declarative(this.id+"-andoncord-check","change",function(b){a.internalRejectedVideo=b.$target.is(":checked")}),
this.A.declarative(this.id+"-btn-close","click",function(){return a.closeFeedbackForm()}),this.A.declarative(this.id+"-btn-cancel","click",function(){return a.cancelFeedbackForm()}),this.A.declarative(this.id+"-btn-submit","click",function(){return a.submitFeedback()}),this.A.on("a:sheet:afterShow:"+this.id+"-sheet",function(b){a.defaultBottomSheetHeight=.75*a.A.$(g).height();a.changeBottomSheetHeight(b,a.defaultBottomSheetHeight);a.showFeedbackForm()}),this.A.on("a:sheet:afterHide:"+this.id+"-sheet",
function(b){a.resetFeedbackForm().hideThankYou();a.A.trigger("vse:"+a.id+":feedback:hidden")}),this.A.on("a:popover:afterShow:"+this.id+"-popover",function(b){a.showFeedbackForm()}),this.A.on("a:popover:afterHide:"+this.id+"-popover",function(b){a.hideFeedbackForm()}),this.registered=!0))}a.prototype.showFeedbackForm=function(b){this.A.trigger("vse:"+this.id+":feedback:shown");return this};a.prototype.hideFeedbackForm=function(){this.isMobile?this.getAndSetBottomSheetInstance()&&this.bottomSheetInstance.hide():
this.getAndSetPopoverInstance()&&this.popoverInstance.hide();this.resetFeedbackForm().hideThankYou();this.A.trigger("vse:"+this.id+":feedback:hidden");return this};a.prototype.setActiveVideoAndSource=function(b,a){this.activeVideo=b;this.activeVideoSource=a};a.prototype.submitFeedback=function(){if(this.isOtherSelected&&this.commentBox&&""===this.commentBox.val())this.commentBox.focus();else{var b={events:[{data:{feedback:{additionalComments:this.commentBox?this.commentBox.val():"",playerVersion:"",
asin:this.pageAsin,videoId:this.activeVideo,videoSource:this.activeVideoSource,violations:this.currentViolations,url:document.location.href,userAgent:g.navigator&&g.navigator.userAgent?g.navigator.userAgent:"window.navigator.userAgent not supported",feedbackTime:this.A.now(),customerId:this.customerId,isInternal:this.isInternal,feedbackWidgetVersion:"2",marketplace:this.marketplaceId,internalRejectedVideo:this.internalRejectedVideo}}}]};this.A.$.ajax({url:this.endpoint,data:JSON.stringify(b),type:"POST",
contentType:"application/json; charset\x3dutf-8",error:this._submitErrorCallback,success:this._submitSuccessCallback});this.A.trigger("vse:"+this.id+":feedback:submitted");this.resetFeedbackForm().showThankYou()}};a.prototype.cancelFeedbackForm=function(){this.resetFeedbackForm();this.A.trigger("vse:"+this.id+":feedback:cancelled")};a.prototype.closeFeedbackForm=function(){this.hideFeedbackForm();this.A.trigger("vse:"+this.id+":feedback:closed")};a.prototype.resetFeedbackForm=function(){this.submitButton.disable();
this.feedbackSection.find(B.ELM_RBTN_CHECKED).each(function(){this.checked=!1});this.updatePlaceholderString(this.optionalCommentMessage);this.commentBox.val("");this.internalRejectedVideo=!1;this.feedbackSection.find(B.ELM_CHECKBOX_CHECKED).each(function(){this.checked=!1});return this};a.prototype.showThankYou=function(){this.feedbackForm.fadeOut(200);this.thankYouSection.addClass("show").removeClass("aok-hidden").fadeIn(400);this.A.trigger("vse:"+this.id+":thank-you:shown");return this};a.prototype.hideThankYou=
function(){this.feedbackForm.fadeIn(10);this.thankYouSection.addClass("aok-hidden").removeClass("show").fadeOut(10);this.A.trigger("vse:"+this.id+":thank-you:hidden");return this};a.prototype.validateFormElements=function(){return this.feedbackSection.length&&this.commentBox.length&&this.thankYouSection.length&&this.submitButton.size()&&this.cancelButton.length&&this.feedbackForm.length};a.prototype.updatePlaceholderString=function(b){this.commentBox.attr(B.ATTR_NAME_PLACEHOLDER,b)};a.prototype.changeBottomSheetHeight=
function(b,a){this.setBottomSheetHeight&&(b.sheet.changeHeight({duration:.3,height:a}),this.setBottomSheetHeight=!1)};a.prototype.getAndSetBottomSheetInstance=function(){return this.bottomSheetFactory?this.bottomSheetInstance?this.bottomSheetInstance:this.bottomSheetInstance=this.bottomSheetFactory.get(this.id+"-sheet"):q};a.prototype.getAndSetPopoverInstance=function(){return this.popoverFactory?this.popoverInstance?this.popoverInstance:this.popoverInstance=this.popoverFactory.get(this.id+"-popover"):
q};return a}(),ea=function(){function a(b){this.config=b;this.feedbackWidgets={}}a.prototype.create=function(b,a){a=this.feedbackWidgets[b]||new da({id:b,pageStateName:a,A:this.config.A,buttonApi:this.config.buttonApi});return this.feedbackWidgets[b]=a};a.prototype.get=function(a){return this.feedbackWidgets[a]};return a}(),fa=function(){function a(a){var c=this;this.config=a;this.playbackCompleteHandler=function(a){return c.onPlaybackComplete(a)};this.playerFullScreenHandler=function(a){return c.onPlayerFullScreen(a)};
this.firstFrameHandler=function(a){return c.onFirstFrame(a)};this.playerLoadedHandler=function(){return c.config.popover.updatePosition()};this.isContinousPlayFinished=this.socialShareIsOpen=this.feedbackIsOpen=this.lightboxPausedVideo=!1;this.lightBoxPopoverClass="vse-lightbox-wrapper";this.shouldSeekVideo=!0;this.seekTime=0;this.isFeedbackCreated=!1;this.relatedProductsNilgiriRequestCount=0;this.refreshSocialSharePageState=function(a){if(c.config.showShareWidget){var b=a.$el?a.$el.children(".vse-carousel-item").data("redirect-url"):
"/dp/"+a.contentId;c.config.A.state.replace("vse-rvp-social-share",{pageLevelData:{clientRef:"lb",deviceTypeRef:c.config.isMobile?"mb":"dt"},url:"https://www.amazon.com"+b,image:a.imageUrl,title:a.title,description:a.title})}};var d=a.customerReview,k=a.videoVoteContainerFactory?a.videoVoteContainerFactory:q;this.dom=new ca(a.$("#"+a.popoverName+"-wrapper"),!!a.useSecondaryView,a.$,a.A,a.productCarouselId,a.showRelatedProducts,d,a.useVerticalLayout,a.showVideoVotes,a.carouselFramework,k);a.mShop&&
a.mShopFactory&&(a.mShopFactory.addEventListener("appPause",function(){c.pauseVideoIfNeeded()}),a.mShopFactory.addEventListener("appResume",function(){c.resumeVideoIfNeeded()}));a.$(document).delegate("#"+a.popoverTriggerId,"click",function(a){return a.preventDefault()});a.A.on("a:popover:beforeHide:"+a.popoverName,function(d){c.config.mShop&&c.config.mShopFactory&&c.config.mShopFactory.dispatchEvent({type:"appOverlays.Show"});c.config.showShareWidget&&(c.socialShareIsOpen&&c.config.A.$("#"+c.config.socialShareId+
"-trigger").removeClass("active"),a.A.trigger("vse:socialShare:"+a.socialShareId+"-show-icons:close"));c.hide();c.config.$("body").removeClass("vse-lb-no-scroll")});a.A.on("a:popover:afterShow:"+a.popoverName,function(d){c.config.A.$(d.popover.$popover).addClass("vse-lightbox-wrapper "+a.A.$("#"+a.popoverName+"-wrapper").data("cssClass"));c.config.mShop&&c.config.$(d.popover.$popover).addClass("vse-lb-mshop");c.isFeedbackCreated||(d=a.flatFeedbackComponentConfig)&&d.features&&d.features.features&&
(c.registerFeedback(d.features.features.context+"-feedback"),c.getFeedback(a,1));c.config.useSecondaryView&&c.dom.resizeMobileLB();c.config.mShop&&c.config.mShopFactory?c.config.mShopFactory.dispatchEvent({type:"appOverlays.Hide"}):c.config.A.trigger("resize",{},{width:g.innerWidth,height:g.innerHeight});c.lastScrollTop=a.$(".vse-vertical-scroll").scrollTop();c.lastTimeScroll=a.A.now();c.config.$("body").addClass("vse-lb-no-scroll")});this.config.showShareWidget&&(a.A.declarative(""+a.socialShareActionName,
"click",function(c){c.$target.hasClass("active")?a.A.trigger("vse:socialShare:"+a.socialShareId+"-show-icons:close"):a.A.trigger("vse:socialShare:"+a.socialShareId+"-show-icons:show");c.$target.toggleClass("active")}),this.registerSocialShare(a));if(a.displayCarousel)a.A.on("vse:contentCarousel:"+a.carouselConfig.carouselName+":click",function(a){c.refreshSocialSharePageState(a);c.getPlayer(a).play(a);c.show(a)})}a.prototype.onFirstFrame=function(a){this.shouldSeekVideo&&(this.getPlayer(a).setCurrentTime(this.seekTime),
this.shouldSeekVideo=!1);this.config.isMobile&&this.hideFeedbackLink("#"+this.config.popoverName+"-feedback-container",".vse-lightbox-player-container video")};a.prototype.startPlaying=function(a,c){this.isContinousPlayFinished=!1;this.getPlayer(a);this.config.popover.show();this.show(a);this.config.autoplay?(this.seekTime=c,this.getPlayer(a).unmute(),this.getPlayer(a).play(a)):!this.config.mShop&&this.config.useSecondaryView||this.getPlayer(a).play(a);this.config.contentCarousel.changeStartingCardTo(a);
return this};a.prototype.show=function(a){this.activeASIN=a.contentId;this.activeVideoAsset=a;this.config.contentCarousel.rotateTo(a);this.dom.update(a,this.config.contentTitle);this.setFeedbackActiveVideoAndSource(a);this.config.showRelatedProducts&&this.showRelatedProducts(a);return this};a.prototype.showRelatedProducts=function(a){this.fadeOutRelatedProductsContainer();var c=a.relatedProducts;""!==c?this.retrieveRelatedProductsCarouselFromCache(a.contentId)!==q?this.getRelatedProductsFromCache(a.contentId):
this.getRelatedProducts(this.config,1,c,a.contentId):this.config.isMobile&&(this.config.A.hide(this.config.A.$(r.narrowContainerMobileSelector)),this.dom.resizeMobileLB())};a.prototype.getRelatedProducts=function(a,c,d,g){var e=this;if(3<c)this.handleGetRelatedProductsFailure();else{var h=!0;0<this.relatedProductsNilgiriRequestCount&&(h=!1);var p=a.relatedProductsComponentConfig,k=a.relatedProductsPageContext;if(p&&k&&p.features&&p.features.features){var u=p.features;this.config.A.ajax("/vap/ew/subcomponent/relatedproducts",
{params:{pageContext:{page:k.page,placement:k.placement,marketplaceID:k.marketplaceID,locale:k.locale,customerId:k.customerId,requestId:k.requestId,product:{contentID:a.pageAsin,contentIDType:"ASIN"},metadata:{relatedProductsAsins:d}},configuration:{id:p.id,type:p.type,binder:p.binder,assets:h?["ProductCarousel"]:[],features:{features:{context:u.features.context,displayStrategy:u.features.displayStrategy,pagestate:u.features.pagestate,explicitlyEmitPageState:u.features.explicitlyEmitPageState,cssClass:u.features.cssClass}}}},
paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(a){-1!==a.indexOf("vse-related-product-container")?(e.cacheRelatedProductsPayload(g,a),e.handleGetRelatedProductsSuccess(g),v.count("rvp:videolightbox:relatedproducts:load:success:",1),e.relatedProductsNilgiriRequestCount+=1):e.handleGetRelatedProductsFailure()},error:function(a){c+=1;e.getRelatedProducts(e.config,c,d,g)}})}}};a.prototype.cacheRelatedProductsPayload=function(a,c){a=this.config.popoverName+
"-vse-pc-hidden-cache-"+a;this.config.A.$(r.cacheRelatedProductsPayloadHiddenDivId).append("\x3cdiv id\x3d'"+a+"'\x3e"+c+" \x3c/div\x3e")};a.prototype.retrieveRelatedProductsCarouselFromCache=function(a){a=this.config.A.$("#"+this.config.popoverName+"-vse-pc-hidden-cache-"+a+" .vse-related-product-container");if(a!==q&&a[0]!==q)return a[0].outerHTML};a.prototype.handleGetRelatedProductsSuccess=function(a){this.fadeInRelatedProductsContainer();var c=this.retrieveRelatedProductsCarouselFromCache(a);
this.hideCurrentlyVisibleProductContainer(a);var d=this.config.popoverName+"-"+r.visibleDivNarrowPrefix+a,g=this.config.popoverName+"-"+r.visibleDivWidePrefix+a;this.config.isMobile?this.appendProductCarouselHTML(r.narrowContainerMobileSelector,d,c):(this.appendProductCarouselHTML(r.narrowContainerSelector,d,c),this.appendProductCarouselHTML(r.wideContainerSelector,g,c));this.showNarrowOrWide(a);this.config.isMobile&&this.dom.resizeMobileLB()};a.prototype.appendProductCarouselHTML=function(a,c,d){this.config.A.$("#"+
this.config.popoverName+"-wrapper "+a).append('\x3cdiv class\x3d"vse-pc-visible aok-hidden" id\x3d\''+c+"'\x3e"+d+"\x3c/div\x3e")};a.prototype.getRelatedProductsFromCache=function(a){this.fadeInRelatedProductsContainer();this.hideCurrentlyVisibleProductContainer(a);this.showNarrowOrWide(a);this.config.isMobile&&this.dom.resizeMobileLB()};a.prototype.hideCurrentlyVisibleProductContainer=function(a){this.config.A.$("[id^\x3dvse-related-products-]").find(".vse-pc-visible").addClass("aok-hidden")};a.prototype.showNarrowOrWide=
function(a){var c=this.config.popoverName+"-"+r.visibleDivNarrowPrefix+a;a=this.config.popoverName+"-"+r.visibleDivWidePrefix+a;this.config.isMobile?(this.config.A.show(this.config.A.$(r.narrowContainerMobileSelector)),this.showIndividualProductCarousel(r.narrowContainerMobileSelector,c)):this.dom.useNarrowContainer?this.showIndividualProductCarousel(r.narrowContainerSelector,c):this.showIndividualProductCarousel(r.wideContainerSelector,a);this.config.carouselFramework.createAll()};a.prototype.showIndividualProductCarousel=
function(a,c){this.config.A.$("#"+c).removeClass("aok-hidden");this.config.A.$("#"+c+" .vse-related-product-container").addClass("vse-remove-opacity")};a.prototype.handleGetRelatedProductsFailure=function(){v.count("rvp:videolightbox:relatedproducts:load:failed",1);this.config.A.$(r.relatedProductsInnerContainer).hide();this.config.isMobile&&(this.config.A.hide(this.config.A.$(r.narrowContainerMobileSelector)),this.dom.resizeMobileLB())};a.prototype.fadeOutRelatedProductsContainer=function(){this.config.A.$(r.relatedProductsInnerContainer).fadeOut(200)};
a.prototype.fadeInRelatedProductsContainer=function(){this.config.A.$(r.relatedProductsInnerContainer).fadeIn(200)};a.prototype.createPlaylist=function(a){this.playlist=a;return this};a.prototype.getCarousel=function(){return this.config.contentCarousel};a.prototype.hide=function(){this.destroyPlayer();this.config.popover.hide();this.config.$("body").removeClass("vse-lb-sc");return this};a.prototype.handleFailFullScreen=function(){this.dom.resizeMobileLB()};a.prototype.hideIfPossible=function(){0==
this.feedbackIsOpen&&1==this.isContinousPlayFinished&&this.hide()};a.prototype.updateVotingElements=function(a,c){this.config.contentCarousel.updateVotingElements(a,c);c=this.activeASIN;for(var d,g=0;g<a.length;g++)if(a[g].contentId===c){d=a[g].positiveVoteCount;a=a[g].negativeVoteCount;this.dom.updateActiveVideoVoteContainer(c,d,a,!0);break}return this};a.prototype.getNextAsset=function(a){for(var c=0;c<this.playlist.length&&this.playlist[c].contentId!=a.contentId;c++);if(c!=this.playlist.length)return this.playlist[c+
1]};a.prototype.pauseVideoIfNeeded=function(){this.player&&this.player.isPlaying()&&(this.player.pause(),this.lightboxPausedVideo=!0)};a.prototype.resumeVideoIfNeeded=function(){this.player&&!this.player.isPlaying()&&!this.isContinousPlayFinished&&this.lightboxPausedVideo&&this.player.resume(Date.now());this.lightboxPausedVideo=!1};a.prototype.getPlayer=function(a){this.player||(this.config.autoplay&&(this.config.playerConfig.shouldStartMuted=!0),a.eventTimestamp&&(this.config.playerConfig.eventTimestamp=
a.eventTimestamp),a.refTag&&(this.config.playerConfig.refTag=a.refTag),this.config.playerConfig.initialVideo=a,this.player=this.config.awaFactory.create(this.config.playerConfig),this.player.on("playbackComplete",this.playbackCompleteHandler),this.player.on("playerLoaded",this.playerLoadedHandler),this.player.on("playerFullScreen",this.playerFullScreenHandler),this.player.on("playbackStart",this.firstFrameHandler));return this.player};a.prototype.destroyPlayer=function(){if(this.player){var a=this.player;
this.player=null;a.off("playbackComplete",this.playbackCompleteHandler);a.off("playerLoaded",this.playerLoadedHandler);a.off("playerFullScreen",this.playerFullScreenHandler);a.off("playbackStart",this.firstFrameHandler);this.shouldSeekVideo=!0;a.destroy();null==this.player}};a.prototype.onPlaybackComplete=function(a){var c=this.getNextAsset(a);c?(this.refreshSocialSharePageState(c),a.eventTimestamp&&(c.eventTimestamp=a.eventTimestamp),this.player.play(c),this.show(c)):(this.isContinousPlayFinished=
!0,this.hideIfPossible())};a.prototype.onPlayerFullScreen=function(a){var c=this.config.$("#"+this.config.popoverName+"-wrapper"),d=this.config.$("."+this.lightBoxPopoverClass);c&&(a?(c.addClass("vse-player-fullscreen"),d.addClass("vse-lb-fullscreen")):(c.removeClass("vse-player-fullscreen"),d.removeClass("vse-lb-fullscreen")))};a.prototype.deRegisterFeedback=function(a){this.config.A.off("vse:"+a+":feedback:shown");this.config.A.off("vse:"+a+":feedback:hidden");this.config.A.off("vse:ns:feedback:"+
a+":init:client")};a.prototype.registerFeedback=function(a){var c=this;this.deRegisterFeedback(a);this.config.A.on("vse:ns:feedback:"+a+":init:client",function(){var d=new ea({A:c.config.A,buttonApi:c.config.buttonApi});c.feedback=d.create(a,a);c.setFeedbackActiveVideoAndSource(c.activeVideoAsset)});var d="#"+this.config.popoverName+"-feedback-container",g=!0,e=!1;this.config.A.declarative.create(this.config.A.$(".vse-lightbox-player-container"),"feedback-overlays-player",{});this.config.A.declarative("feedback-overlays-player",
"mouseenter touchstart focus",function(a){(g||c.config.isMobile)&&c.showFeedbackLink(d,".vse-lightbox-player-container video");e=!0});this.config.A.declarative("feedback-overlays-player","mouseleave",function(a){(g||c.config.isMobile)&&c.hideFeedbackLink(d,".vse-lightbox-player-container video");e=!1});this.config.A.on("vse:"+a+":feedback:shown",function(){c.pauseVideoIfNeeded();g=!1});this.config.A.on("vse:"+a+":feedback:hidden",function(){c.resumeVideoIfNeeded();g=!0;e||c.hideFeedbackLink(d,".vse-lightbox-player-container video")});
this.config.A.on("vse:"+a+":feedback:hidden",function(){c.config.mShop&&c.config.mShopFactory&&c.config.A.delay(function(){c.config.mShopFactory.dispatchEvent({type:"appOverlays.Hide"})},500)})};a.prototype.showFeedbackLink=function(a,c){this.config.A.$(a).css({display:"inline-block"});this.config.A.$(c).addClass("dim-video-player")};a.prototype.hideFeedbackLink=function(a,c){this.config.A.$(a).css({display:"none"});this.config.A.$(c).removeClass("dim-video-player")};a.prototype.deRegisterSocialShare=
function(a){a.A.off("vse:socialShare:"+a.socialShareId+"-show-icons:show");a.A.off("vse:socialShare:"+a.socialShareId+"-show-icons:close")};a.prototype.registerSocialShare=function(a){var c=this;this.deRegisterSocialShare(a);a.A.on("vse:socialShare:"+a.socialShareId+"-show-icons:show",function(){c.socialShareIsOpen=!0});a.A.on("vse:socialShare:"+a.socialShareId+"-show-icons:close",function(){c.socialShareIsOpen=!1})};a.prototype._adjustLightbox=function(){this.dom.resizeMobileLB()};a.prototype.setFeedbackActiveVideoAndSource=
function(a){this.isFeedbackCreated&&a&&this.feedback.setActiveVideoAndSource(a.contentId,a.vendorCode)};a.prototype.getFeedback=function(a,c){var d=this;if(3<c)v.count("rvp:videolightbox:feedback:load:failed",1);else{var g=a.flatFeedbackComponentConfig,e=g.features,h=a.flatFeedbackPageContext;this.config.A.ajax("/vap/ew/subcomponent/feedback",{params:{pageContext:{page:h.page,placement:h.placement,marketplaceID:h.marketplaceID,locale:h.locale,customerId:h.customerId,requestId:h.requestId,product:{contentID:a.pageAsin,
contentIDType:"ASIN"}},configuration:{id:g.id,type:g.type,binder:g.binder,features:{features:{infringementUrl:e.features.infringementUrl,endpoint:e.features.endpoint,reftagprefix:e.features.reftagprefix,context:e.features.context}}}},paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(a){d.config.A.$("#"+d.config.popoverName+"-feedback-container").html(a);d.isFeedbackCreated=!0;v.count("rvp:videolightbox:feedback:load:success:",1)},error:function(e){c+=
1;d.getFeedback(a,c)}})}};return a}(),ga=function(){function a(){}a.prototype.markPlaying=function(a){};a.prototype.rotateTo=function(a){};a.prototype.changeStartingCardTo=function(a){};a.prototype.getplaylist=function(){return[]};a.prototype.getActiveAsset=function(){return{}};a.prototype.findIndex=function(a){return-1};a.prototype.destroy=function(){};a.prototype.emitRefTag=function(a,c){};a.prototype.updateVotingElements=function(a,c){};return a}(),R=null;t.when("mash").execute(function(a){R=a});
var ha={getMash:function(){return R}},ia=function(){return function(a){this.message=a}}(),S=function(){function a(a){this.constructorConfig=a}a.prototype.create=function(a){var c=this.constructorConfig.modalFactory.get(this.constructorConfig.$("#"+a.popoverTriggerId)),d=a.mShop?ha.getMash():null,g=this.constructorConfig.videoVoteContainerFactory?this.constructorConfig.videoVoteContainerFactory:q;if(!c)throw new ia("Cannot create popover using name "+a.popoverName);var e=a.displayCarousel?this.constructorConfig.contentCarouselFactory.create(a.carouselConfig):
new ga;return new fa({popoverName:a.popoverName,popoverTriggerId:a.popoverTriggerId,playerConfig:a.playerConfig,displayCarousel:a.displayCarousel,carouselConfig:a.carouselConfig,contentTitle:a.contentTitle,useSecondaryView:a.useSecondaryView,displayActiveVideoDetails:a.displayActiveVideoDetails,popover:c,$:this.constructorConfig.$,contentCarousel:e,mShopFactory:d,buttonApi:this.constructorConfig.buttonApi,pageAsin:a.pageAsin,flatFeedbackComponentConfig:a.flatFeedbackComponentConfig,flatFeedbackPageContext:a.flatFeedbackPageContext,
productCarouselId:a.productCarouselId,awaFactory:this.constructorConfig.awaFactory,mShop:a.mShop,A:this.constructorConfig.A,feedbackEndpoint:a.feedbackEndpoint,showProductCarousel:a.showProductCarousel,recordProductMetrics:a.recordProductMetrics,featProductsUrl:a.featProductsUrl,showShareWidget:a.showShareWidget,socialShareId:a.socialShareId,socialShareActionName:a.socialShareActionName,isMobile:a.isMobile,autoplay:a.autoplay,customerReview:a.customerReview,useVerticalLayout:a.useVerticalLayout,videoVoteContainerFactory:g,
showVideoVotes:a.showVideoVotes,relatedProductsComponentConfig:a.relatedProductsComponentConfig,relatedProductsPageContext:a.relatedProductsPageContext,showRelatedProducts:a.showRelatedProducts,carouselFramework:this.constructorConfig.carouselFramework})};return a}(),l=function(){function a(){}a.INSTANCE="vse:rvs";a.METRIC_TIME_TO_REGISTERED="vse:csm:vse-rel-videos-carousel:loadedAndRegistered:time";a.METRIC_TIME_TO_NOT_REGISTERED="vse:csm:vse-rel-videos-carousel:loadedNotRegistered:time";a.METRIC_INIT_CLIENT=
a.INSTANCE+":init-client";a.METRIC_INIT_CLIENT_WAITING=a.INSTANCE+":init-client:waiting";a.METRIC_INIT_CLIENT_PLAYERS=a.INSTANCE+":init-client:players";a.METRIC_PAGE_VIEW=a.INSTANCE+":page:view";a.METRIC_WIDGET_CLICK=a.INSTANCE+":widget:click";a.VIEWABLE_SECONDS=2;a.METRIC_PAGE_VIEW_MA=a.INSTANCE+":ma:page:view";a.METRIC_WIDGET_CLICK_MA=a.INSTANCE+":ma:widget:click";a.METRIC_VIDEO_VIEWABLE=a.INSTANCE+":ma:viewable";a.METRIC_VIDEO_VIEWABLE_X=a.INSTANCE+":ma:viewable:x";a.METRIC_WIDGET_VIEW=a.INSTANCE+
":ma:widget:view";a.METRIC_WIDGET_SWIPE=a.INSTANCE+":ma:widget:swipe";a.METRIC_SCROLL_PTFF=a.INSTANCE+":ma:scroll:ptff";a.METRIC_SWIPE_PTFF=a.INSTANCE+":ma:swipe:ptff";a.SLOT_NUMBERS=["one","two","three","four"];a.METRIC_PLAYER_ASYNCHRONOUS_ERROR=a.INSTANCE+":ma:error";a.PLAYER_CONTAINER_ID_PREFIX="vse-rvs-ingress-player-";a.muteButtonSrc="https://m.media-amazon.com/images/G/01/vse/Discovery/mute._CB474746454_.png";a.unmuteButtonSrc="https://m.media-amazon.com/images/G/01/vse/Discovery/unmute._CB474746442_.png";
a.EMPTY_STRING="";a.socialSharePageStateName="vse-rvp-social-share";a.socialShareClickMetricName="vseSocialShareClickRvs";return a}(),c={variables:{A:{},lightbox:null,ingressCarousel:null,RVA_SUSHI_URL:l.EMPTY_STRING,buildMetricPayload:{},buildUniversalSushiPayload:{},sushiMetricsConfig:null,isVerticalScroll:!0,playHeadPosition:-1,playList:[],playStartTime:-1,rvaVideoViewRecorded:!1,rvaViewTimeoutId:-1,shouldMute:!0,universalSushiEndpoint:l.EMPTY_STRING,vsePlayerList:[],vsePlayerState:[],wasCarouselInView:!1,
showVideoVotes:!1,videoVoteContainerFactory:null,libs:{}},BrilaFactory:L,GatedP:H,PostMetric:v,MetricUtils:C,AuiUtils:D,VoteData:G,VideoVoteContainer:E,VideoVoteContainerFactory:I,EventEmitter:N,VideoLightboxFactory:S,makeApplicationSushiPayloadBuilder:C.makeApplicationSushiPayloadBuilder,emitMetric:function(a,b){if(g.ue)try{g.ue.count(a,b)}catch(f){c.logError(f,"vse-related-video-shorts-metrics","Failed to log CSM level metric.")}},emitSushiMetric:function(a,b){a=c.variables.buildUniversalSushiPayload({eventName:a,
stringPayload:l.EMPTY_STRING,intPayload:b});v.emitSushiMetric(a,c.variables.universalSushiEndpoint)},emitViewableView:function(a){if(!(0>c.variables.playHeadPosition)){var b=c.variables.vsePlayerList[a].getPosition()-c.variables.playHeadPosition;c.variables.playHeadPosition=-1;b>=l.VIEWABLE_SECONDS&&(c.emitMetric(l.METRIC_VIDEO_VIEWABLE,1),0<=a&&a<l.SLOT_NUMBERS.length?c.emitMetric(l.METRIC_VIDEO_VIEWABLE+":"+l.SLOT_NUMBERS[a],1):c.emitMetric(l.METRIC_VIDEO_VIEWABLE_X,1))}},findContentId:function(a,
b){var f=null;c.variables.A.each(a,function(a){a.contentId===b&&(f=a)});return f},isDefined:function(a){return"undefined"!==typeof a&&null!==a},mutedPause:function(a){if(!c.variables.vsePlayerState[a])return c.variables;try{c.variables.vsePlayerList[a].pause(),c.variables.vsePlayerState[a]=!1,c.emitViewableView(a)}catch(b){c.emitMetric(l.METRIC_PLAYER_ASYNCHRONOUS_ERROR,1)}},mutedPlay:function(a){if(c.variables.vsePlayerState[a])return c.variables;var b=c.variables.vsePlayerList[a];c.variables.vsePlayerState[a]=
!0;c.variables.playHeadPosition=b.getPosition();c.variables.playStartTime=Date.now();b.play()},setPlayerState:function(a){c.variables.vsePlayerState[a]=!1},isScrolledIntoView:function(a,b){var c=a.$(g);a=c.scrollTop();var c=a+c.height(),d=b.offset().top+.4*b.height();return b.offset().top+.6*b.height()<=c&&d>=a},makeMetricPayloadBuilder:function(a){return function(b){b.sessionId=a.sessionId;b.requestId=a.requestId;b.customerId=a.customerId;b.marketplaceId=a.marketplaceId;b.pageAsin=a.pageAsin;b.timestamp=
new Date;return{events:[{data:b}]}}},registerClientEventOnce:function(a,b,f,d,g,e){e.clickHandle&&a.off(e.clickHandle);e.closeHandle&&a.off(e.closeHandle);e.videoVoteCastHandle&&a.off(e.videoVoteCastHandle);e.videoVoteHistoryHandle&&a.off(e.videoVoteHistoryHandle);e.videoVoteCountHandle&&a.off(e.videoVoteCountHandle);e.closeHandle=a.on("a:popover:beforeHide:"+f.popoverName,function(a){g.destroy()});e.clickHandle=a.on("vse:contentCarousel:"+b.carouselName+":click",function(e){for(var g=d.getCarousel().getplaylist(),
k=0,u=0;u<g.length;u++){if(g[0].contentId===e.contentId){b.autoplay&&"undefined"!==typeof c.variables.vsePlayerList[u]&&(c.mutedPause(u),c.variables.wasCarouselInView=!1,k=c.variables.vsePlayerList[u].getCurrentTime());break}g.push(g.shift())}u=C.makeApplicationSushiPayloadBuilder(c.variables.A,c.variables.sushiMetricsConfig);if(f.showShareWidget){var n=e.$el?e.$el.children(".vse-carousel-item").data("redirect-url"):"/dp/"+e.contentId;a.state.replace("vse-rvp-social-share",{pageLevelData:{clientRef:"lb",
deviceTypeRef:f.isMobile?"mb":"dt"},url:"https://www.amazon.com"+n,image:e.imageUrl,title:e.title,description:e.title})}c.emitMetric(l.METRIC_WIDGET_CLICK,1);c.variables.universalSushiEndpoint!==l.EMPTY_STRING&&(u=u({eventName:"rvs.widgetClick",stringPayload:l.EMPTY_STRING,intPayload:1}),v.emitSushiMetric(u,c.variables.universalSushiEndpoint));b.autoplayTriggered&&c.emitMetric(l.METRIC_WIDGET_CLICK_MA,1);d.createPlaylist(g);d.startPlaying(e,k)});c.variables.showVideoVotes&&c.variables.videoVoteContainerFactory&&
c.variables.videoVoteContainerFactory.videoVoteConfig&&(e.videoVoteCastHandle=a.on(c.variables.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast",function(a){var b=a===k.POSITIVE_VOTE?k.NEGATIVE_VOTE:k.POSITIVE_VOTE,e=c.ingressCarousel.getActiveAsset().contentId,f=c.findContentId(c.ingressCarousel.getplaylist(),e),g=c.findContentId(d.getCarousel().getplaylist(),e),b=f&&f.videoVoteContainer.getPreviousVote()===a?"cancel:"+a:!f||f.videoVoteContainer.getPreviousVote()!==k.POSITIVE_VOTE&&
f.videoVoteContainer.getPreviousVote()!==k.NEGATIVE_VOTE?a:"switch-"+b+"-to-"+a;null!==f&&f.videoVoteContainer.updateWithNewVote(a);null!==g&&g.videoVoteContainer.updateWithNewVote(a);c.variables.universalSushiEndpoint!==l.EMPTY_STRING&&(a=c.variables.buildUniversalSushiPayload({eventName:"rvs.videovote.castvote:"+b,stringPayload:l.EMPTY_STRING,intPayload:1,videoAsin:e}),v.emitSushiMetric(a,c.variables.universalSushiEndpoint))}),e.videoVoteHistoryHandle=a.on(c.variables.videoVoteContainerFactory.videoVoteConfig.actionPrefix+
"-history-set",function(a){var b=d.getCarousel().getActiveAsset().contentId,e=c.findContentId(c.ingressCarousel.getplaylist(),b),b=c.findContentId(d.getCarousel().getplaylist(),b);e&&e.videoVoteContainer.setPreviousVote(a);b&&b.videoVoteContainer.setPreviousVote(a)}),e.videoVoteCountHandle=a.on(c.variables.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-counts-fetched",function(a){c.ingressCarousel.updateVotingElements(a,!1);c.lightbox.updateVotingElements(a,!1)}));return e},beginTrackingRvaViewTimer:function(){var a=
c.variables.vsePlayerList[0].getPosition();a>=l.VIEWABLE_SECONDS?(c.variables.sushiMetricsConfig&&c.variables.sushiMetricsConfig.hasOwnProperty("endpoint")&&(a=c.variables.buildMetricPayload({videoAsin:c.variables.playList[0].contentId,name:"vse.related_video_advertising.videoView"}),v.emitSushiMetric(a,c.variables.RVA_SUSHI_URL)),c.variables.rvaViewTimeoutId=-1,c.variables.rvaVideoViewRecorded=!0):c.variables.rvaViewTimeoutId=c.variables.A.delay(c.beginTrackingRvaViewTimer,1E3*(l.VIEWABLE_SECONDS-
a))},verticalScrollHandler:function(a,b,f){"undefined"!==typeof b&&(c.isScrolledIntoView(a,b)?(c.variables.wasCarouselInView||c.emitMetric(l.METRIC_WIDGET_VIEW,1),c.variables.wasCarouselInView=!0,c.variables.isVerticalScroll=!0,c.mutedPlay(f),-1!==c.variables.rvaViewTimeoutId||c.variables.rvaVideoViewRecorded||(c.variables.rvaViewTimeoutId=a.delay(c.beginTrackingRvaViewTimer,1E3*(l.VIEWABLE_SECONDS-c.variables.vsePlayerList[0].getPosition())))):(c.variables.wasCarouselInView=!1,c.mutedPause(f),-1!==
c.variables.rvaViewTimeoutId&&(clearTimeout(c.variables.rvaViewTimeoutId),c.variables.rvaViewTimeoutId=-1)))},firstFrameHandler:function(){if(!(0>c.variables.playStartTime)){var a=c.variables.isVerticalScroll?l.METRIC_SCROLL_PTFF:l.METRIC_SWIPE_PTFF,b=Date.now()-c.variables.playStartTime;c.emitMetric(a,b);c.variables.isVerticalScroll=!1;c.variables.playStartTime=-1}},createPlayer:function(a,b,f,d,g){var e=a.$.extend({},d),h=c.variables.shouldMute?l.muteButtonSrc:l.unmuteButtonSrc;d=a.$.extend({},
d.videoAds);var k=b[f];b=l.PLAYER_CONTAINER_ID_PREFIX+(f+1);var n=c.makeMetricPayloadBuilder(c.variables.sushiMetricsConfig);e.requestMetadata.method=e.requestMetadata.method.replace("vse_lb","vse_rva");e.initialVideo=k;e.containerId=b;e.shouldStartMuted=c.variables.shouldMute;e.shouldDisableControls=!0;e.airyVersion="VideoJS";e.videoAds=d;e.videoAds.isEngineEnabled=!1;a.$("#"+b).find("img").hide();a.$("#"+b).find("p").hide();c.variables.vsePlayerList[f]=g.create(e);c.variables.vsePlayerList[f].on("playbackStart",
c.firstFrameHandler);c.variables.vsePlayerList[f].on("playbackComplete",function(a){c.setPlayerState(f)});a.$("#"+b+"-container").wrap('\x3cdiv class\x3d"vse-rvs-autoplay-container"\x3e\x3c/div\x3e');a.$("#"+b+"-container").after("\x3cdiv class \x3d 'vse-rvp-overlap-player'\x3e\x3c/div\x3e\x3cimg class\x3d'vse-rvp-mutebutton' src\x3d"+h+" /\x3e");a.$("#"+b).find(".vse-rvp-overlap-player").bind("click",function(a){c.variables.sushiMetricsConfig&&c.variables.sushiMetricsConfig.hasOwnProperty("endpoint")&&
(a=n({videoAsin:k.contentId,name:"vse.related_video_advertising.videoClick"}),v.emitSushiMetric(a,c.variables.RVA_SUSHI_URL))});a.$("#"+b).find(".vse-rvp-mutebutton").bind("click",function(b){b.stopPropagation();b.preventDefault();b=0;for(var d=c.variables.vsePlayerList;b<d.length;b++){var e=d[b];if("undefined"===typeof e)break;e.isMuted()?(c.variables.shouldMute=!1,a.$(".vse-rvp-mutebutton").attr("src",l.unmuteButtonSrc),e.unmute(),c.variables.sushiMetricsConfig&&c.variables.sushiMetricsConfig.hasOwnProperty("endpoint")&&
(e=n({name:"vse.related_video_advertising.unmuteClick",videoAsin:k.contentId}),v.emitSushiMetric(e,c.variables.RVA_SUSHI_URL))):(c.variables.shouldMute=!0,a.$(".vse-rvp-mutebutton").attr("src",l.muteButtonSrc),e.mute())}})},AutoPlayInitialization:function(a,b,f,d){for(var k=a.now(),e=0;e<Math.min(2,c.variables.playList.length);e++)c.createPlayer(a,c.variables.playList,e,f,d);c.variables.vsePlayerList[0].on("playbackComplete",function(b){c.mutedPlay(0);c.variables.rvaVideoViewRecorded=!1;a.delay(c.beginTrackingRvaViewTimer,
l.VIEWABLE_SECONDS)});var h=0,p=0;a.on("a:carousel:"+b.carouselName+":updatePageIndex",function(a,b){h=p;p=(a-1)*b});a.$(g).unload(function(){c.emitViewableView(p)});var n=a.$("#vse-rvs-ingress-player-1");a.on("a:carousel:"+b.carouselName+":scrollCarousel",function(b,e){h=p;p=(b-1)*e;if(c.isScrolledIntoView(a,n)){c.mutedPause(h);if(p>h)for(b=0;2>=b;b++)e=p+b,e<c.variables.playList.length&&"undefined"===typeof c.variables.vsePlayerList[e]&&c.createPlayer(a,c.variables.playList,e,f,d);c.emitMetric(l.METRIC_WIDGET_SWIPE,
1);c.mutedPlay(p)}});a.on("vse:rva:carousel:"+b.carouselName+":productClick",function(a){c.variables.sushiMetricsConfig&&c.variables.sushiMetricsConfig.hasOwnProperty("endpoint")&&(a=c.variables.buildMetricPayload(a),v.emitSushiMetric(a,c.variables.RVA_SUSHI_URL))});c.variables.vsePlayerList[p].on("playerLoaded",function(b){c.verticalScrollHandler(a,n,p)});c.verticalScrollHandler(a,n,p);a.on.scroll(function(){c.verticalScrollHandler(a,n,p)});c.emitMetric(l.METRIC_INIT_CLIENT_PLAYERS,a.now()-k)},log:function(a,
b,c,d){g.ueLogError&&g.ueLogError(b,{logLevel:a,attribution:c,message:d})},logFatal:function(a,b,f){c.log("FATAL",a,b,f)},logError:function(a,b,f){c.log("ERROR",a,b,f)},getMshopShareParams:function(a,b){a=c.constructShareBaseUrl()+a;b=b+" "+a;var f="\x3cdiv\x3e \x3cp\x3e"+b+" "+a+"\x3c/p\x3e \x3c/div\x3e";return{subject:b,messagePlain160:b.substring(0,160),messagePlain140:b.substring(0,140),messageHTML:f,messagePlain:b,url:a}},constructShareBaseUrl:function(){return(c.isDefined(g.location.origin)?
g.location.origin:"https://www.amazon.com")+"/vdp/"}},T=1,ka=function(a){return new a(function(a,f){t.when("A").register("VSE-RVS-client",function(d){var f={clickHandle:null,closeHandle:null,videoVoteCastHandle:null,videoVoteHistoryHandle:null,videoVoteCountHandle:null};c.variables.A=d;return{initializeClient:function(a,b,d,g,k,n,q,m){try{var r=a.now();a.$("#va-related-videos-widget_feature_div").removeClass("aok-hidden");a.$("#vse-spinner").removeClass("aok-hidden");var z=D.fetchLatestPageState(a,
"vse-dp-rv-config"),w=D.fetchLatestPageState(a,"vse-dp-vl-config"),B=D.fetchLatestPageState(a,"vse-dp-rvs-config"),C=D.fetchLatestPageState(a,"vse-dp-rvs-ad-metrics-url");c.variables.sushiMetricsConfig=D.fetchLatestPageState(a,"vse-dp-rvs-sushimetricsconfig");C&&C.url&&(c.variables.RVA_SUSHI_URL=C.url);if(z&&0!==z.length&&(z.showAdPlacement||w&&0!==w.length)){c.variables.sushiMetricsConfig&&c.variables.sushiMetricsConfig.hasOwnProperty("endpoint")?c.variables.universalSushiEndpoint=c.variables.sushiMetricsConfig.endpoint:
c.variables.universalSushiEndpoint="";c.variables.buildMetricPayload=c.makeMetricPayloadBuilder(c.variables.sushiMetricsConfig);c.variables.buildUniversalSushiPayload=c.makeApplicationSushiPayloadBuilder(a,c.variables.sushiMetricsConfig);g={gatedP:H,EventEmitter:N,promise:n};c.variables.libs=g;var E=new ba(b,a,g),F=new L(g),J=a.$.extend({},w.videoVoteConfig);J.hasOwnProperty("placementContext")&&(J.dependencies=g,c.variables.videoVoteContainerFactory=new I(a,J),c.variables.showVideoVotes=w.showVideoVotes);
var G=new S({modalFactory:d,contentCarouselFactory:E,$:a.$,A:a,buttonApi:k,awaFactory:F,videoVoteContainerFactory:c.variables.videoVoteContainerFactory,carouselFramework:b});c.ingressCarousel=E.create(z);c.variables.playList=c.ingressCarousel.getplaylist();1<=c.variables.playList.length&&z.autoplay&&c.AutoPlayInitialization(a,z,B,F);z.showAdPlacement||(c.lightbox=G.create(w),f=c.registerClientEventOnce(a,z,w,c.lightbox,c.ingressCarousel,f));a.off("a:declarative:vse-rvp-swf-share-network:click");a.on("a:declarative:vse-rvp-swf-share-network:click",
function(b){v.count(l.socialShareClickMetricName,1);var c=a.state(l.socialSharePageStateName);V.share(c,b.data.network)});t.when("mash").execute("vse-mash-detection",function(b){c.isMshop=!0;c.mShopFactory=b;a.declarative("vse-rvp-social-share-mshop-action","click touch",function(a){a=c.ingressCarousel.getActiveAsset();a=c.getMshopShareParams(a.contentId,a.title);c.mShopFactory.share(a)})});b=T-m;var K=a.now();d=K-m;c.emitMetric(l.METRIC_TIME_TO_NOT_REGISTERED,b);c.emitMetric(l.METRIC_TIME_TO_REGISTERED,
d);c.emitMetric(l.METRIC_INIT_CLIENT,K-r);c.emitMetric(l.METRIC_INIT_CLIENT_WAITING,r-m);""!==c.variables.universalSushiEndpoint&&(c.emitSushiMetric("rvs.requestToLoadDuration",b),c.emitSushiMetric("rvs.requestToReadyDuration",d),c.emitSushiMetric("rvs.initToReadyDuration",K-r),c.emitSushiMetric("rvs.requestToInitDuration",r-m));a.$("#vse-spinner").addClass("aok-hidden");c.emitMetric(l.METRIC_PAGE_VIEW,1);""!==c.variables.universalSushiEndpoint&&c.emitSushiMetric("rvs.pageView",1);z.autoplayTriggered&&
c.emitMetric(l.METRIC_PAGE_VIEW_MA,1)}}catch(ja){a.$("#va-related-videos-widget_feature_div").addClass("aok-hidden"),c.logFatal(ja,"vse-related-video-shorts","Failed to create the video light-box experience.")}},Utils:c,_noneFeature:a()}})})};t.when("A","3p-promise").execute("VSE-gatedP-register-client",function(a,b){T=a.now();H.register("VSE-RVS-client","VSE-RVS-client-registered",ka,b)})})()});